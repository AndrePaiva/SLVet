(function(e,t,n){function r(e){var t=[];for(var n=0,r=e.length;n<r;n++){t[e[n]]=n}return t}function i(e,t,n){var r=e.splice(t,1)[0];e.splice(n,0,r)}function s(e,t,n){var r=[];for(var i=0,s=e.childNodes.length;i<s;i++){if(e.childNodes[i].nodeType==1){r.push(e.childNodes[i])}}var o=r[t];if(n!==null){e.insertBefore(o,r[n])}else{e.appendChild(o)}}$.fn.dataTableExt.oApi.fnColReorder=function(e,t,n){var o=$.fn.dataTable.Api?true:false;var u,a,f,l,c=e.aoColumns.length,h,p;if(t==n){return}if(t<0||t>=c){this.oApi._fnLog(e,1,"ColReorder 'from' index is out of bounds: "+t);return}if(n<0||n>=c){this.oApi._fnLog(e,1,"ColReorder 'to' index is out of bounds: "+n);return}var d=[];for(u=0,a=c;u<a;u++){d[u]=u}i(d,t,n);var v=r(d);for(u=0,a=e.aaSorting.length;u<a;u++){e.aaSorting[u][0]=v[e.aaSorting[u][0]]}if(e.aaSortingFixed!==null){for(u=0,a=e.aaSortingFixed.length;u<a;u++){e.aaSortingFixed[u][0]=v[e.aaSortingFixed[u][0]]}}for(u=0,a=c;u<a;u++){p=e.aoColumns[u];for(f=0,l=p.aDataSort.length;f<l;f++){p.aDataSort[f]=v[p.aDataSort[f]]}if(o){p.idx=v[p.idx]}}if(o){$.each(e.aLastSort,function(t,n){e.aLastSort[t].src=v[n.src]})}for(u=0,a=c;u<a;u++){p=e.aoColumns[u];if(typeof p.mData=="number"){p.mData=v[p.mData];e.oApi._fnColumnOptions(e,u,{})}}if(e.aoColumns[t].bVisible){var m=this.oApi._fnColumnIndexToVisible(e,t);var g=null;u=n<t?n:n+1;while(g===null&&u<c){g=this.oApi._fnColumnIndexToVisible(e,u);u++}h=e.nTHead.getElementsByTagName("tr");for(u=0,a=h.length;u<a;u++){s(h[u],m,g)}if(e.nTFoot!==null){h=e.nTFoot.getElementsByTagName("tr");for(u=0,a=h.length;u<a;u++){s(h[u],m,g)}}for(u=0,a=e.aoData.length;u<a;u++){if(e.aoData[u].nTr!==null){s(e.aoData[u].nTr,m,g)}}}i(e.aoColumns,t,n);i(e.aoPreSearchCols,t,n);for(u=0,a=e.aoData.length;u<a;u++){var y=e.aoData[u];if(o){if(y.anCells){i(y.anCells,t,n)}if(y.src!=="dom"&&$.isArray(y._aData)){i(y._aData,t,n)}}else{if($.isArray(y._aData)){i(y._aData,t,n)}i(y._anHidden,t,n)}}for(u=0,a=e.aoHeader.length;u<a;u++){i(e.aoHeader[u],t,n)}if(e.aoFooter!==null){for(u=0,a=e.aoFooter.length;u<a;u++){i(e.aoFooter[u],t,n)}}if(o){var b=new $.fn.dataTable.Api(e);b.rows().invalidate()}for(u=0,a=c;u<a;u++){$(e.aoColumns[u].nTh).off("click.DT");this.oApi._fnSortAttachListener(e,e.aoColumns[u].nTh,u)}$(e.oInstance).trigger("column-reorder",[e,{iFrom:t,iTo:n,aiInvertMapping:v}])};var o=function(e,s){"use strict";var o=function(t,n){var r;if(e.fn.dataTable.Api){r=(new e.fn.dataTable.Api(t)).settings()[0]}else if(t.fnSettings){r=t.fnSettings()}else if(typeof t==="string"){if(e.fn.dataTable.fnIsDataTable(e(t)[0])){r=e(t).eq(0).dataTable().fnSettings()}}else if(t.nodeName&&t.nodeName.toLowerCase()==="table"){if(e.fn.dataTable.fnIsDataTable(t.nodeName)){r=e(t.nodeName).dataTable().fnSettings()}}else if(t instanceof jQuery){if(e.fn.dataTable.fnIsDataTable(t[0])){r=t.eq(0).dataTable().fnSettings()}}else{r=t}if(e.fn.dataTable.camelToHungarian){e.fn.dataTable.camelToHungarian(o.defaults,n||{})}this.s={dt:null,init:e.extend(true,{},o.defaults,n),fixed:0,fixedRight:0,dropCallback:null,mouse:{startX:-1,startY:-1,offsetX:-1,offsetY:-1,target:-1,targetIndex:-1,fromIndex:-1},aoTargets:[]};this.dom={drag:null,pointer:null};this.s.dt=r.oInstance.fnSettings();this.s.dt._colReorder=this;this._fnConstruct();r.oApi._fnCallbackReg(r,"aoDestroyCallback",e.proxy(this._fnDestroy,this),"ColReorder");return this};o.prototype={fnReset:function(){var e=[];for(var t=0,n=this.s.dt.aoColumns.length;t<n;t++){e.push(this.s.dt.aoColumns[t]._ColReorder_iOrigCol)}this._fnOrderColumns(e);return this},fnGetCurrentOrder:function(){return this.fnOrder()},fnOrder:function(e){if(e===n){var t=[];for(var i=0,s=this.s.dt.aoColumns.length;i<s;i++){t.push(this.s.dt.aoColumns[i]._ColReorder_iOrigCol)}return t}this._fnOrderColumns(r(e));return this},_fnConstruct:function(){var e=this;var t=this.s.dt.aoColumns.length;var n;if(this.s.init.iFixedColumns){this.s.fixed=this.s.init.iFixedColumns}this.s.fixedRight=this.s.init.iFixedColumnsRight?this.s.init.iFixedColumnsRight:0;if(this.s.init.fnReorderCallback){this.s.dropCallback=this.s.init.fnReorderCallback}for(n=0;n<t;n++){if(n>this.s.fixed-1&&n<t-this.s.fixedRight){this._fnMouseListener(n,this.s.dt.aoColumns[n].nTh)}this.s.dt.aoColumns[n]._ColReorder_iOrigCol=n}this.s.dt.oApi._fnCallbackReg(this.s.dt,"aoStateSaveParams",function(t,n){e._fnStateSave.call(e,n)},"ColReorder_State");var i=null;if(this.s.init.aiOrder){i=this.s.init.aiOrder.slice()}if(this.s.dt.oLoadedState&&typeof this.s.dt.oLoadedState.ColReorder!="undefined"&&this.s.dt.oLoadedState.ColReorder.length==this.s.dt.aoColumns.length){i=this.s.dt.oLoadedState.ColReorder}if(i){if(!e.s.dt._bInitComplete){var s=false;this.s.dt.aoDrawCallback.push({fn:function(){if(!e.s.dt._bInitComplete&&!s){s=true;var t=r(i);e._fnOrderColumns.call(e,t)}},sName:"ColReorder_Pre"})}else{var o=r(i);e._fnOrderColumns.call(e,o)}}else{this._fnSetColumnIndexes()}},_fnOrderColumns:function(t){if(t.length!=this.s.dt.aoColumns.length){this.s.dt.oInstance.oApi._fnLog(this.s.dt,1,"ColReorder - array reorder does not "+"match known number of columns. Skipping.");return}for(var n=0,r=t.length;n<r;n++){var s=e.inArray(n,t);if(n!=s){i(t,s,n);this.s.dt.oInstance.fnColReorder(s,n)}}if(this.s.dt.oScroll.sX!==""||this.s.dt.oScroll.sY!==""){this.s.dt.oInstance.fnAdjustColumnSizing()}this.s.dt.oInstance.oApi._fnSaveState(this.s.dt);this._fnSetColumnIndexes()},_fnStateSave:function(t){var n,r,i,s;var o=this.s.dt;for(n=0;n<t.aaSorting.length;n++){t.aaSorting[n][0]=o.aoColumns[t.aaSorting[n][0]]._ColReorder_iOrigCol}var u=e.extend(true,[],t.aoSearchCols);t.ColReorder=[];for(n=0,r=o.aoColumns.length;n<r;n++){s=o.aoColumns[n]._ColReorder_iOrigCol;t.aoSearchCols[s]=u[n];t.abVisCols[s]=o.aoColumns[n].bVisible;t.ColReorder.push(s)}},_fnMouseListener:function(t,n){var r=this;e(n).on("mousedown.ColReorder",function(e){e.preventDefault();r._fnMouseDown.call(r,e,n)})},_fnMouseDown:function(r,i){var s=this;var o=e(r.target).closest("th, td");var u=o.offset();var a=parseInt(e(i).attr("data-column-index"),10);if(a===n){return}this.s.mouse.startX=r.pageX;this.s.mouse.startY=r.pageY;this.s.mouse.offsetX=r.pageX-u.left;this.s.mouse.offsetY=r.pageY-u.top;this.s.mouse.target=this.s.dt.aoColumns[a].nTh;this.s.mouse.targetIndex=a;this.s.mouse.fromIndex=a;this._fnRegions();e(t).on("mousemove.ColReorder",function(e){s._fnMouseMove.call(s,e)}).on("mouseup.ColReorder",function(e){s._fnMouseUp.call(s,e)})},_fnMouseMove:function(e){var t=this;if(this.dom.drag===null){if(Math.pow(Math.pow(e.pageX-this.s.mouse.startX,2)+Math.pow(e.pageY-this.s.mouse.startY,2),.5)<5){return}this._fnCreateDragNode()}this.dom.drag.css({left:e.pageX-this.s.mouse.offsetX,top:e.pageY-this.s.mouse.offsetY});var n=false;var r=this.s.mouse.toIndex;for(var i=1,s=this.s.aoTargets.length;i<s;i++){if(e.pageX<this.s.aoTargets[i-1].x+(this.s.aoTargets[i].x-this.s.aoTargets[i-1].x)/2){this.dom.pointer.css("left",this.s.aoTargets[i-1].x);this.s.mouse.toIndex=this.s.aoTargets[i-1].to;n=true;break}}if(!n){this.dom.pointer.css("left",this.s.aoTargets[this.s.aoTargets.length-1].x);this.s.mouse.toIndex=this.s.aoTargets[this.s.aoTargets.length-1].to}if(this.s.init.bRealtime&&r!==this.s.mouse.toIndex){this.s.dt.oInstance.fnColReorder(this.s.mouse.fromIndex,this.s.mouse.toIndex);this.s.mouse.fromIndex=this.s.mouse.toIndex;this._fnRegions()}},_fnMouseUp:function(n){var r=this;e(t).off("mousemove.ColReorder mouseup.ColReorder");if(this.dom.drag!==null){this.dom.drag.remove();this.dom.pointer.remove();this.dom.drag=null;this.dom.pointer=null;this.s.dt.oInstance.fnColReorder(this.s.mouse.fromIndex,this.s.mouse.toIndex);this._fnSetColumnIndexes();if(this.s.dt.oScroll.sX!==""||this.s.dt.oScroll.sY!==""){this.s.dt.oInstance.fnAdjustColumnSizing()}if(this.s.dropCallback!==null){this.s.dropCallback.call(this)}this.s.dt.oInstance.oApi._fnSaveState(this.s.dt)}},_fnRegions:function(){var t=this.s.dt.aoColumns;this.s.aoTargets.splice(0,this.s.aoTargets.length);this.s.aoTargets.push({x:e(this.s.dt.nTable).offset().left,to:0});var n=0;for(var r=0,i=t.length;r<i;r++){if(r!=this.s.mouse.fromIndex){n++}if(t[r].bVisible){this.s.aoTargets.push({x:e(t[r].nTh).offset().left+e(t[r].nTh).outerWidth(),to:n})}}if(this.s.fixedRight!==0){this.s.aoTargets.splice(this.s.aoTargets.length-this.s.fixedRight)}if(this.s.fixed!==0){this.s.aoTargets.splice(0,this.s.fixed)}},_fnCreateDragNode:function(){var t=this.s.dt.oScroll.sX!==""||this.s.dt.oScroll.sY!=="";var n=this.s.dt.aoColumns[this.s.mouse.targetIndex].nTh;var r=n.parentNode;var i=r.parentNode;var s=i.parentNode;var o=e(n).clone();this.dom.drag=e(s.cloneNode(false)).addClass("DTCR_clonedTable").append(i.cloneNode(false).appendChild(r.cloneNode(false).appendChild(o[0]))).css({position:"absolute",top:0,left:0,width:e(n).outerWidth(),height:e(n).outerHeight()}).appendTo("body");this.dom.pointer=e("<div></div>").addClass("DTCR_pointer").css({position:"absolute",top:t?e("div.dataTables_scroll",this.s.dt.nTableWrapper).offset().top:e(this.s.dt.nTable).offset().top,height:t?e("div.dataTables_scroll",this.s.dt.nTableWrapper).height():e(this.s.dt.nTable).height()}).appendTo("body")},_fnDestroy:function(){var t,n;for(t=0,n=this.s.dt.aoDrawCallback.length;t<n;t++){if(this.s.dt.aoDrawCallback[t].sName==="ColReorder_Pre"){this.s.dt.aoDrawCallback.splice(t,1);break}}e(this.s.dt.nTHead).find("*").off(".ColReorder");e.each(this.s.dt.aoColumns,function(t,n){e(n.nTh).removeAttr("data-column-index")});this.s.dt._colReorder=null;this.s=null},_fnSetColumnIndexes:function(){e.each(this.s.dt.aoColumns,function(t,n){e(n.nTh).attr("data-column-index",t)})}};o.defaults={aiOrder:null,bRealtime:false,iFixedColumns:0,iFixedColumnsRight:0,fnReorderCallback:null};o.version="1.1.1";e.fn.dataTable.ColReorder=o;e.fn.DataTable.ColReorder=o;if(typeof e.fn.dataTable=="function"&&typeof e.fn.dataTableExt.fnVersionCheck=="function"&&e.fn.dataTableExt.fnVersionCheck("1.9.3")){e.fn.dataTableExt.aoFeatures.push({fnInit:function(e){var t=e.oInstance;if(!e._colReorder){var n=e.oInit;var r=n.colReorder||n.oColReorder||{};new o(e,r)}else{t.oApi._fnLog(e,1,"ColReorder attempted to initialise twice. Ignoring second")}return null},cFeature:"R",sFeature:"ColReorder"})}else{alert("Warning: ColReorder requires DataTables 1.9.3 or greater - www.datatables.net/download")}if(e.fn.dataTable.Api){e.fn.dataTable.Api.register("colReorder.reset()",function(){return this.iterator("table",function(e){e._colReorder.fnReset()})});e.fn.dataTable.Api.register("colReorder.order()",function(e){if(e){return this.iterator("table",function(t){t._colReorder.fnOrder(e)})}return this.context.length?this.context[0]._colReorder.fnOrder():null})}return o};if(typeof define==="function"&&define.amd){define("datatables-colreorder",["jquery","datatables"],o)}else if(jQuery&&!jQuery.fn.dataTable.ColReorder){o(jQuery,jQuery.fn.dataTable)}})(window,document)