(function(e){"use strict";e.fmatter={};e.extend(e.fmatter,{isBoolean:function(e){return typeof e==="boolean"},isObject:function(t){return t&&(typeof t==="object"||e.isFunction(t))||false},isString:function(e){return typeof e==="string"},isNumber:function(e){return typeof e==="number"&&isFinite(e)},isValue:function(e){return this.isObject(e)||this.isString(e)||this.isNumber(e)||this.isBoolean(e)},isEmpty:function(t){if(!this.isString(t)&&this.isValue(t)){return false}if(!this.isValue(t)){return true}t=e.trim(t).replace(/\&nbsp\;/ig,"").replace(/\&#160\;/ig,"");return t===""}});e.fn.fmatter=function(t,n,r,i,s){var o=n;r=e.extend({},e.jgrid.formatter,r);try{o=e.fn.fmatter[t].call(this,n,r,i,s)}catch(u){}return o};e.fmatter.util={NumberFormat:function(t,n){if(!e.fmatter.isNumber(t)){t*=1}if(e.fmatter.isNumber(t)){var r=t<0;var i=String(t);var s=n.decimalSeparator||".";var o;if(e.fmatter.isNumber(n.decimalPlaces)){var u=n.decimalPlaces;var a=Math.pow(10,u);i=String(Math.round(t*a)/a);o=i.lastIndexOf(".");if(u>0){if(o<0){i+=s;o=i.length-1}else if(s!=="."){i=i.replace(".",s)}while(i.length-1-o<u){i+="0"}}}if(n.thousandsSeparator){var f=n.thousandsSeparator;o=i.lastIndexOf(s);o=o>-1?o:i.length;var l=i.substring(o);var c=-1,h;for(h=o;h>0;h--){c++;if(c%3===0&&h!==o&&(!r||h>1)){l=f+l}l=i.charAt(h-1)+l}i=l}i=n.prefix?n.prefix+i:i;i=n.suffix?i+n.suffix:i;return i}return t}};e.fn.fmatter.defaultFormat=function(t,n){return e.fmatter.isValue(t)&&t!==""?t:n.defaultValue||"&#160;"};e.fn.fmatter.email=function(t,n){if(!e.fmatter.isEmpty(t)){return'<a href="mailto:'+t+'">'+t+"</a>"}return e.fn.fmatter.defaultFormat(t,n)};e.fn.fmatter.checkbox=function(t,n){var r=e.extend({},n.checkbox),i;if(n.colModel!==undefined&&n.colModel.formatoptions!==undefined){r=e.extend({},r,n.colModel.formatoptions)}if(r.disabled===true){i='disabled="disabled"'}else{i=""}if(e.fmatter.isEmpty(t)||t===undefined){t=e.fn.fmatter.defaultFormat(t,r)}t=String(t);t=(t+"").toLowerCase();var s=t.search(/(false|f|0|no|n|off|undefined)/i)<0?" checked='checked' ":"";return'<input type="checkbox" '+s+' value="'+t+'" offval="no" '+i+"/>"};e.fn.fmatter.link=function(t,n){var r={target:n.target};var i="";if(n.colModel!==undefined&&n.colModel.formatoptions!==undefined){r=e.extend({},r,n.colModel.formatoptions)}if(r.target){i="target="+r.target}if(!e.fmatter.isEmpty(t)){return"<a "+i+' href="'+t+'">'+t+"</a>"}return e.fn.fmatter.defaultFormat(t,n)};e.fn.fmatter.showlink=function(t,n){var r={baseLinkUrl:n.baseLinkUrl,showAction:n.showAction,addParam:n.addParam||"",target:n.target,idName:n.idName},i="",s;if(n.colModel!==undefined&&n.colModel.formatoptions!==undefined){r=e.extend({},r,n.colModel.formatoptions)}if(r.target){i="target="+r.target}s=r.baseLinkUrl+r.showAction+"?"+r.idName+"="+n.rowId+r.addParam;if(e.fmatter.isString(t)||e.fmatter.isNumber(t)){return"<a "+i+' href="'+s+'">'+t+"</a>"}return e.fn.fmatter.defaultFormat(t,n)};e.fn.fmatter.integer=function(t,n){var r=e.extend({},n.integer);if(n.colModel!==undefined&&n.colModel.formatoptions!==undefined){r=e.extend({},r,n.colModel.formatoptions)}if(e.fmatter.isEmpty(t)){return r.defaultValue}return e.fmatter.util.NumberFormat(t,r)};e.fn.fmatter.number=function(t,n){var r=e.extend({},n.number);if(n.colModel!==undefined&&n.colModel.formatoptions!==undefined){r=e.extend({},r,n.colModel.formatoptions)}if(e.fmatter.isEmpty(t)){return r.defaultValue}return e.fmatter.util.NumberFormat(t,r)};e.fn.fmatter.currency=function(t,n){var r=e.extend({},n.currency);if(n.colModel!==undefined&&n.colModel.formatoptions!==undefined){r=e.extend({},r,n.colModel.formatoptions)}if(e.fmatter.isEmpty(t)){return r.defaultValue}return e.fmatter.util.NumberFormat(t,r)};e.fn.fmatter.date=function(t,n,r,i){var s=e.extend({},n.date);if(n.colModel!==undefined&&n.colModel.formatoptions!==undefined){s=e.extend({},s,n.colModel.formatoptions)}if(!s.reformatAfterEdit&&i==="edit"){return e.fn.fmatter.defaultFormat(t,n)}if(!e.fmatter.isEmpty(t)){return e.jgrid.parseDate(s.srcformat,t,s.newformat,s)}return e.fn.fmatter.defaultFormat(t,n)};e.fn.fmatter.select=function(t,n){t=String(t);var r=false,i=[],s,o;if(n.colModel.formatoptions!==undefined){r=n.colModel.formatoptions.value;s=n.colModel.formatoptions.separator===undefined?":":n.colModel.formatoptions.separator;o=n.colModel.formatoptions.delimiter===undefined?";":n.colModel.formatoptions.delimiter}else if(n.colModel.editoptions!==undefined){r=n.colModel.editoptions.value;s=n.colModel.editoptions.separator===undefined?":":n.colModel.editoptions.separator;o=n.colModel.editoptions.delimiter===undefined?";":n.colModel.editoptions.delimiter}if(r){var u=n.colModel.editoptions.multiple===true?true:false,a=[],f;if(u){a=t.split(",");a=e.map(a,function(t){return e.trim(t)})}if(e.fmatter.isString(r)){var l=r.split(o),c=0,h;for(h=0;h<l.length;h++){f=l[h].split(s);if(f.length>2){f[1]=e.map(f,function(e,t){if(t>0){return e}}).join(s)}if(u){if(e.inArray(f[0],a)>-1){i[c]=f[1];c++}}else if(e.trim(f[0])===e.trim(t)){i[0]=f[1];break}}}else if(e.fmatter.isObject(r)){if(u){i=e.map(a,function(e){return r[e]})}else{i[0]=r[t]||""}}}t=i.join(", ");return t===""?e.fn.fmatter.defaultFormat(t,n):t};e.fn.fmatter.rowactions=function(t){var n=e(this).closest("tr.jqgrow"),r=n.attr("id"),i=e(this).closest("table.ui-jqgrid-btable").attr("id").replace(/_frozen([^_]*)$/,"$1"),s=e("#"+i),o=s[0],u=o.p,a=u.colModel[e.jgrid.getCellIndex(this)],f=a.frozen?e("tr#"+r+" td:eq("+e.jgrid.getCellIndex(this)+") > div",s):e(this).parent(),l={extraparam:{}},c=function(t,n){if(e.isFunction(l.afterSave)){l.afterSave.call(o,t,n)}f.find("div.ui-inline-edit,div.ui-inline-del").show();f.find("div.ui-inline-save,div.ui-inline-cancel").hide()},h=function(t){if(e.isFunction(l.afterRestore)){l.afterRestore.call(o,t)}f.find("div.ui-inline-edit,div.ui-inline-del").show();f.find("div.ui-inline-save,div.ui-inline-cancel").hide()};if(a.formatoptions!==undefined){l=e.extend(l,a.formatoptions)}if(u.editOptions!==undefined){l.editOptions=u.editOptions}if(u.delOptions!==undefined){l.delOptions=u.delOptions}if(n.hasClass("jqgrid-new-row")){l.extraparam[u.prmNames.oper]=u.prmNames.addoper}var p={keys:l.keys,oneditfunc:l.onEdit,successfunc:l.onSuccess,url:l.url,extraparam:l.extraparam,aftersavefunc:c,errorfunc:l.onError,afterrestorefunc:h,restoreAfterError:l.restoreAfterError,mtype:l.mtype};switch(t){case"edit":s.jqGrid("editRow",r,p);f.find("div.ui-inline-edit,div.ui-inline-del").hide();f.find("div.ui-inline-save,div.ui-inline-cancel").show();s.triggerHandler("jqGridAfterGridComplete");break;case"save":if(s.jqGrid("saveRow",r,p)){f.find("div.ui-inline-edit,div.ui-inline-del").show();f.find("div.ui-inline-save,div.ui-inline-cancel").hide();s.triggerHandler("jqGridAfterGridComplete")}break;case"cancel":s.jqGrid("restoreRow",r,h);f.find("div.ui-inline-edit,div.ui-inline-del").show();f.find("div.ui-inline-save,div.ui-inline-cancel").hide();s.triggerHandler("jqGridAfterGridComplete");break;case"del":s.jqGrid("delGridRow",r,l.delOptions);break;case"formedit":s.jqGrid("setSelection",r);s.jqGrid("editGridRow",r,l.editOptions);break}};e.fn.fmatter.actions=function(t,n){var r={keys:false,editbutton:true,delbutton:true,editformbutton:false},i=n.rowId,s="",o;if(n.colModel.formatoptions!==undefined){r=e.extend(r,n.colModel.formatoptions)}if(i===undefined||e.fmatter.isEmpty(i)){return""}if(r.editformbutton){o="id='jEditButton_"+i+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'formedit'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";s+="<div title='"+e.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+o+"><span class='ui-icon ui-icon-pencil'></span></div>"}else if(r.editbutton){o="id='jEditButton_"+i+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'edit'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover') ";s+="<div title='"+e.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+o+"><span class='ui-icon ui-icon-pencil'></span></div>"}if(r.delbutton){o="id='jDeleteButton_"+i+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'del'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";s+="<div title='"+e.jgrid.nav.deltitle+"' style='float:left;margin-left:5px;' class='ui-pg-div ui-inline-del' "+o+"><span class='ui-icon ui-icon-trash'></span></div>"}o="id='jSaveButton_"+i+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'save'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";s+="<div title='"+e.jgrid.edit.bSubmit+"' style='float:left;display:none' class='ui-pg-div ui-inline-save' "+o+"><span class='ui-icon ui-icon-disk'></span></div>";o="id='jCancelButton_"+i+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'cancel'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";s+="<div title='"+e.jgrid.edit.bCancel+"' style='float:left;display:none;margin-left:5px;' class='ui-pg-div ui-inline-cancel' "+o+"><span class='ui-icon ui-icon-cancel'></span></div>";return"<div style='margin-left:8px;'>"+s+"</div>"};e.unformat=function(t,n,r,i){var s,o=n.colModel.formatter,u=n.colModel.formatoptions||{},a,f=/([\.\*\_\'\(\)\{\}\+\?\\])/g,l=n.colModel.unformat||e.fn.fmatter[o]&&e.fn.fmatter[o].unformat;if(l!==undefined&&e.isFunction(l)){s=l.call(this,e(t).text(),n,t)}else if(o!==undefined&&e.fmatter.isString(o)){var c=e.jgrid.formatter||{},h;switch(o){case"integer":u=e.extend({},c.integer,u);a=u.thousandsSeparator.replace(f,"\\$1");h=new RegExp(a,"g");s=e(t).text().replace(h,"");break;case"number":u=e.extend({},c.number,u);a=u.thousandsSeparator.replace(f,"\\$1");h=new RegExp(a,"g");s=e(t).text().replace(h,"").replace(u.decimalSeparator,".");break;case"currency":u=e.extend({},c.currency,u);a=u.thousandsSeparator.replace(f,"\\$1");h=new RegExp(a,"g");s=e(t).text();if(u.prefix&&u.prefix.length){s=s.substr(u.prefix.length)}if(u.suffix&&u.suffix.length){s=s.substr(0,s.length-u.suffix.length)}s=s.replace(h,"").replace(u.decimalSeparator,".");break;case"checkbox":var p=n.colModel.editoptions?n.colModel.editoptions.value.split(":"):["Yes","No"];s=e("input",t).is(":checked")?p[0]:p[1];break;case"select":s=e.unformat.select(t,n,r,i);break;case"actions":return"";default:s=e(t).text()}}return s!==undefined?s:i===true?e(t).text():e.jgrid.htmlDecode(e(t).html())};e.unformat.select=function(t,n,r,i){var s=[];var o=e(t).text();if(i===true){return o}var u=e.extend({},n.colModel.formatoptions!==undefined?n.colModel.formatoptions:n.colModel.editoptions),a=u.separator===undefined?":":u.separator,f=u.delimiter===undefined?";":u.delimiter;if(u.value){var l=u.value,c=u.multiple===true?true:false,h=[],p;if(c){h=o.split(",");h=e.map(h,function(t){return e.trim(t)})}if(e.fmatter.isString(l)){var d=l.split(f),v=0,m;for(m=0;m<d.length;m++){p=d[m].split(a);if(p.length>2){p[1]=e.map(p,function(e,t){if(t>0){return e}}).join(a)}if(c){if(e.inArray(p[1],h)>-1){s[v]=p[0];v++}}else if(e.trim(p[1])===e.trim(o)){s[0]=p[0];break}}}else if(e.fmatter.isObject(l)||e.isArray(l)){if(!c){h[0]=o}s=e.map(h,function(t){var n;e.each(l,function(e,r){if(r===t){n=e;return false}});if(n!==undefined){return n}})}return s.join(", ")}return o||""};e.unformat.date=function(t,n){var r=e.jgrid.formatter.date||{};if(n.formatoptions!==undefined){r=e.extend({},r,n.formatoptions)}if(!e.fmatter.isEmpty(t)){return e.jgrid.parseDate(r.newformat,t,r.srcformat,r)}return e.fn.fmatter.defaultFormat(t,n)}})(jQuery)