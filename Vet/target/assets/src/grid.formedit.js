(function(e){"use strict";var t={};e.jgrid.extend({searchGrid:function(t){t=e.extend(true,{recreateFilter:false,drag:true,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:true,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,afterChange:null,closeAfterSearch:false,closeAfterReset:false,closeOnEscape:false,searchOnEnter:false,multipleSearch:false,multipleGroup:false,top:0,left:0,jqModal:true,modal:false,resize:true,width:450,height:"auto",dataheight:"auto",showQuery:false,errorcheck:true,sopt:null,stringResult:undefined,onClose:null,onSearch:null,onReset:null,toTop:true,overlay:30,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:false,layer:null,operands:{eq:"=",ne:"<>",lt:"<",le:"<=",gt:">",ge:">=",bw:"LIKE",bn:"NOT LIKE","in":"IN",ni:"NOT IN",ew:"LIKE",en:"NOT LIKE",cn:"LIKE",nc:"NOT LIKE",nu:"IS NULL",nn:"ISNOT NULL"}},e.jgrid.search,t||{});return this.each(function(){function a(s){i=e(n).triggerHandler("jqGridFilterBeforeShow",[s]);if(i===undefined){i=true}if(i&&e.isFunction(t.beforeShowSearch)){i=t.beforeShowSearch.call(n,s)}if(i){e.jgrid.viewModal("#"+e.jgrid.jqID(o.themodal),{gbox:"#gbox_"+e.jgrid.jqID(r),jqm:t.jqModal,modal:t.modal,overlay:t.overlay,toTop:t.toTop});e(n).triggerHandler("jqGridFilterAfterShow",[s]);if(e.isFunction(t.afterShowSearch)){t.afterShowSearch.call(n,s)}}}var n=this;if(!n.grid){return}var r="fbox_"+n.p.id,i=true,s=true,o={themodal:"searchmod"+r,modalhead:"searchhd"+r,modalcontent:"searchcnt"+r,scrollelm:r},u=n.p.postData[t.sFilter];if(typeof u==="string"){u=e.jgrid.parse(u)}if(t.recreateFilter===true){e("#"+e.jgrid.jqID(o.themodal)).remove()}if(e("#"+e.jgrid.jqID(o.themodal))[0]!==undefined){a(e("#fbox_"+e.jgrid.jqID(+n.p.id)))}else{var f=e("<div><div id='"+r+"' class='searchFilter' style='overflow:auto'></div></div>").insertBefore("#gview_"+e.jgrid.jqID(n.p.id)),l="left",c="";if(n.p.direction==="rtl"){l="right";c=" style='text-align:left'";f.attr("dir","rtl")}var h=e.extend([],n.p.colModel),d="<a id='"+r+"_search' class='fm-button ui-state-default ui-corner-all fm-button-icon-right ui-reset'><span class='ui-icon ui-icon-search'></span>"+t.Find+"</a>",v="<a id='"+r+"_reset' class='fm-button ui-state-default ui-corner-all fm-button-icon-left ui-search'><span class='ui-icon ui-icon-arrowreturnthick-1-w'></span>"+t.Reset+"</a>",m="",g="",y,b=false,w,E=-1;if(t.showQuery){m="<a id='"+r+"_query' class='fm-button ui-state-default ui-corner-all fm-button-icon-left'><span class='ui-icon ui-icon-comment'></span>Query</a>"}if(!t.columns.length){e.each(h,function(e,t){if(!t.label){t.label=n.p.colNames[e]}if(!b){var r=t.search===undefined?true:t.search,i=t.hidden===true,s=t.searchoptions&&t.searchoptions.searchhidden===true;if(s&&r||r&&!i){b=true;y=t.index||t.name;E=e}}})}else{h=t.columns;E=0;y=h[0].index||h[0].name}if(!u&&y||t.multipleSearch===false){var S="eq";if(E>=0&&h[E].searchoptions&&h[E].searchoptions.sopt){S=h[E].searchoptions.sopt[0]}else if(t.sopt&&t.sopt.length){S=t.sopt[0]}u={groupOp:"AND",rules:[{field:y,op:S,data:""}]}}b=false;if(t.tmplNames&&t.tmplNames.length){b=true;g=t.tmplLabel;g+="<select class='ui-template'>";g+="<option value='default'>Default</option>";e.each(t.tmplNames,function(e,t){g+="<option value='"+e+"'>"+t+"</option>"});g+="</select>"}w="<table class='EditTable' style='border:0px none;margin-top:5px' id='"+r+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='EditButton' style='text-align:"+l+"'>"+v+g+"</td><td class='EditButton' "+c+">"+m+d+"</td></tr></tbody></table>";r=e.jgrid.jqID(r);e("#"+r).jqFilter({columns:h,filter:t.loadDefaults?u:null,showQuery:t.showQuery,errorcheck:t.errorcheck,sopt:t.sopt,groupButton:t.multipleGroup,ruleButtons:t.multipleSearch,afterRedraw:t.afterRedraw,ops:t.odata,operands:t.operands,ajaxSelectOptions:n.p.ajaxSelectOptions,groupOps:t.groupOps,onChange:function(){if(this.p.showQuery){e(".query",this).html(this.toUserFriendlyString())}if(e.isFunction(t.afterChange)){t.afterChange.call(n,e("#"+r),t)}},direction:n.p.direction,id:n.p.id});f.append(w);if(b&&t.tmplFilters&&t.tmplFilters.length){e(".ui-template",f).bind("change",function(){var n=e(this).val();if(n==="default"){e("#"+r).jqFilter("addFilter",u)}else{e("#"+r).jqFilter("addFilter",t.tmplFilters[parseInt(n,10)])}return false})}if(t.multipleGroup===true){t.multipleSearch=true}e(n).triggerHandler("jqGridFilterInitialize",[e("#"+r)]);if(e.isFunction(t.onInitializeSearch)){t.onInitializeSearch.call(n,e("#"+r))}t.gbox="#gbox_"+r;if(t.layer){e.jgrid.createModal(o,f,t,"#gview_"+e.jgrid.jqID(n.p.id),e("#gbox_"+e.jgrid.jqID(n.p.id))[0],"#"+e.jgrid.jqID(t.layer),{position:"relative"})}else{e.jgrid.createModal(o,f,t,"#gview_"+e.jgrid.jqID(n.p.id),e("#gbox_"+e.jgrid.jqID(n.p.id))[0])}if(t.searchOnEnter||t.closeOnEscape){e("#"+e.jgrid.jqID(o.themodal)).keydown(function(n){var i=e(n.target);if(t.searchOnEnter&&n.which===13&&!i.hasClass("add-group")&&!i.hasClass("add-rule")&&!i.hasClass("delete-group")&&!i.hasClass("delete-rule")&&(!i.hasClass("fm-button")||!i.is("[id$=_query]"))){e("#"+r+"_search").click();return false}if(t.closeOnEscape&&n.which===27){e("#"+e.jgrid.jqID(o.modalhead)).find(".ui-jqdialog-titlebar-close").click();return false}})}if(m){e("#"+r+"_query").bind("click",function(){e(".queryresult",f).toggle();return false})}if(t.stringResult===undefined){t.stringResult=t.multipleSearch}e("#"+r+"_search").bind("click",function(){var i=e("#"+r),u={},a,f;i.find(".input-elm:focus").change();f=i.jqFilter("filterData");if(t.errorcheck){i[0].hideError();if(!t.showQuery){i.jqFilter("toSQLString")}if(i[0].p.error){i[0].showError();return false}}if(t.stringResult){try{a=xmlJsonClass.toJson(f,"","",false)}catch(l){try{a=JSON.stringify(f)}catch(c){}}if(typeof a==="string"){u[t.sFilter]=a;e.each([t.sField,t.sValue,t.sOper],function(){u[this]=""})}}else{if(t.multipleSearch){u[t.sFilter]=f;e.each([t.sField,t.sValue,t.sOper],function(){u[this]=""})}else{u[t.sField]=f.rules[0].field;u[t.sValue]=f.rules[0].data;u[t.sOper]=f.rules[0].op;u[t.sFilter]=""}}n.p.search=true;e.extend(n.p.postData,u);s=e(n).triggerHandler("jqGridFilterSearch");if(s===undefined){s=true}if(s&&e.isFunction(t.onSearch)){s=t.onSearch.call(n,n.p.filters)}if(s!==false){e(n).trigger("reloadGrid",[{page:1}])}if(t.closeAfterSearch){e.jgrid.hideModal("#"+e.jgrid.jqID(o.themodal),{gb:"#gbox_"+e.jgrid.jqID(n.p.id),jqm:t.jqModal,onClose:t.onClose})}return false});e("#"+r+"_reset").bind("click",function(){var i={},u=e("#"+r);n.p.search=false;n.p.resetsearch=true;if(t.multipleSearch===false){i[t.sField]=i[t.sValue]=i[t.sOper]=""}else{i[t.sFilter]=""}u[0].resetFilter();if(b){e(".ui-template",f).val("default")}e.extend(n.p.postData,i);s=e(n).triggerHandler("jqGridFilterReset");if(s===undefined){s=true}if(s&&e.isFunction(t.onReset)){s=t.onReset.call(n)}if(s!==false){e(n).trigger("reloadGrid",[{page:1}])}if(t.closeAfterReset){e.jgrid.hideModal("#"+e.jgrid.jqID(o.themodal),{gb:"#gbox_"+e.jgrid.jqID(n.p.id),jqm:t.jqModal,onClose:t.onClose})}return false});a(e("#"+r));e(".fm-button:not(.ui-state-disabled)",f).hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")})}})},editGridRow:function(n,r){r=e.extend(true,{top:0,left:0,width:300,datawidth:"auto",height:"auto",dataheight:"auto",modal:false,overlay:30,drag:true,resize:true,url:null,mtype:"POST",clearAfterAdd:true,closeAfterEdit:false,reloadAfterSubmit:true,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:false,jqModal:true,closeOnEscape:false,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[false,13],navkeys:[false,38,40],checkOnSubmit:false,checkOnUpdate:false,_savedData:{},processing:false,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:true,overlayClass:"ui-widget-overlay"},e.jgrid.edit,r||{});t[e(this)[0].p.id]=r;return this.each(function(){function S(){e(a+" > tbody > tr > td > .FormElement").each(function(){var t=e(".customelement",this);if(t.length){var n=t[0],r=e(n).attr("name");e.each(i.p.colModel,function(){if(this.name===r&&this.editoptions&&e.isFunction(this.editoptions.custom_value)){try{y[r]=this.editoptions.custom_value.call(i,e("#"+e.jgrid.jqID(r),a),"get");if(y[r]===undefined){throw"e1"}}catch(t){if(t==="e1"){e.jgrid.info_dialog(e.jgrid.errors.errcap,"function 'custom_value' "+e.jgrid.edit.msg.novalue,e.jgrid.edit.bClose)}else{e.jgrid.info_dialog(e.jgrid.errors.errcap,t.message,e.jgrid.edit.bClose)}}return true}})}else{switch(e(this).get(0).type){case"checkbox":if(e(this).is(":checked")){y[this.name]=e(this).val()}else{var s=e(this).attr("offval");y[this.name]=s}break;case"select-one":y[this.name]=e("option:selected",this).val();break;case"select-multiple":y[this.name]=e(this).val();if(y[this.name]){y[this.name]=y[this.name].join(",")}else{y[this.name]=""}var o=[];e("option:selected",this).each(function(t,n){o[t]=e(n).text()});break;case"password":case"text":case"textarea":case"button":y[this.name]=e(this).val();break}if(i.p.autoencode){y[this.name]=e.jgrid.htmlEncode(y[this.name])}}});return true}function x(n,r,s,u){var a,f,l,c=0,h,p,d,v=[],m=false,g="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>",y="",b;for(b=1;b<=u;b++){y+=g}if(n!=="_empty"){m=e(r).jqGrid("getInd",n)}e(r.p.colModel).each(function(g){a=this.name;if(this.editrules&&this.editrules.edithidden===true){f=false}else{f=this.hidden===true?true:false}p=f?"style='display:none'":"";if(a!=="cb"&&a!=="subgrid"&&this.editable===true&&a!=="rn"){if(m===false){h=""}else{if(a===r.p.ExpandColumn&&r.p.treeGrid===true){h=e("td[role='gridcell']:eq("+g+")",r.rows[m]).text()}else{try{h=e.unformat.call(r,e("td[role='gridcell']:eq("+g+")",r.rows[m]),{rowId:n,colModel:this},g)}catch(b){h=this.edittype&&this.edittype==="textarea"?e("td[role='gridcell']:eq("+g+")",r.rows[m]).text():e("td[role='gridcell']:eq("+g+")",r.rows[m]).html()}if(!h||h==="&nbsp;"||h==="&#160;"||h.length===1&&h.charCodeAt(0)===160){h=""}}}var w=e.extend({},this.editoptions||{},{id:a,name:a}),E=e.extend({},{elmprefix:"",elmsuffix:"",rowabove:false,rowcontent:""},this.formoptions||{}),S=parseInt(E.rowpos,10)||c+1,x=parseInt((parseInt(E.colpos,10)||1)*2,10);if(n==="_empty"&&w.defaultValue){h=e.isFunction(w.defaultValue)?w.defaultValue.call(i):w.defaultValue}if(!this.edittype){this.edittype="text"}if(i.p.autoencode){h=e.jgrid.htmlDecode(h)}d=e.jgrid.createEl.call(i,this.edittype,w,h,false,e.extend({},e.jgrid.ajaxOptions,r.p.ajaxSelectOptions||{}));if(t[i.p.id].checkOnSubmit||t[i.p.id].checkOnUpdate){t[i.p.id]._savedData[a]=h}e(d).addClass("FormElement");if(e.inArray(this.edittype,["text","textarea","password","select"])>-1){e(d).addClass("ui-widget-content ui-corner-all")}l=e(s).find("tr[rowpos="+S+"]");if(E.rowabove){var T=e("<tr><td class='contentinfo' colspan='"+u*2+"'>"+E.rowcontent+"</td></tr>");e(s).append(T);T[0].rp=S}if(l.length===0){l=e("<tr "+p+" rowpos='"+S+"'></tr>").addClass("FormData").attr("id","tr_"+a);e(l).append(y);e(s).append(l);l[0].rp=S}e("td:eq("+(x-2)+")",l[0]).html(E.label===undefined?r.p.colNames[g]:E.label);e("td:eq("+(x-1)+")",l[0]).append(E.elmprefix).append(d).append(E.elmsuffix);if(this.edittype==="custom"&&e.isFunction(w.custom_value)){w.custom_value.call(i,e("#"+a,"#"+o),"set",h)}e.jgrid.bindEv.call(i,d,w);v[c]=g;c++}});if(c>0){var w=e("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(u*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+r.p.id+"_id' value='"+n+"'/></td></tr>");w[0].rp=c+999;e(s).append(w);if(t[i.p.id].checkOnSubmit||t[i.p.id].checkOnUpdate){t[i.p.id]._savedData[r.p.id+"_id"]=n}}return v}function T(n,r,s){var o,u=0,f,l,c,h,p;if(t[i.p.id].checkOnSubmit||t[i.p.id].checkOnUpdate){t[i.p.id]._savedData={};t[i.p.id]._savedData[r.p.id+"_id"]=n}var d=r.p.colModel;if(n==="_empty"){e(d).each(function(){o=this.name;c=e.extend({},this.editoptions||{});l=e("#"+e.jgrid.jqID(o),"#"+s);if(l&&l.length&&l[0]!==null){h="";if(this.edittype==="custom"&&e.isFunction(c.custom_value)){c.custom_value.call(i,e("#"+o,"#"+s),"set",h)}else if(c.defaultValue){h=e.isFunction(c.defaultValue)?c.defaultValue.call(i):c.defaultValue;if(l[0].type==="checkbox"){p=h.toLowerCase();if(p.search(/(false|f|0|no|n|off|undefined)/i)<0&&p!==""){l[0].checked=true;l[0].defaultChecked=true;l[0].value=h}else{l[0].checked=false;l[0].defaultChecked=false}}else{l.val(h)}}else{if(l[0].type==="checkbox"){l[0].checked=false;l[0].defaultChecked=false;h=e(l).attr("offval")}else if(l[0].type&&l[0].type.substr(0,6)==="select"){l[0].selectedIndex=0}else{l.val(h)}}if(t[i.p.id].checkOnSubmit===true||t[i.p.id].checkOnUpdate){t[i.p.id]._savedData[o]=h}}});e("#id_g","#"+s).val(n);return}var v=e(r).jqGrid("getInd",n,true);if(!v){return}e('td[role="gridcell"]',v).each(function(a){o=d[a].name;if(o!=="cb"&&o!=="subgrid"&&o!=="rn"&&d[a].editable===true){if(o===r.p.ExpandColumn&&r.p.treeGrid===true){f=e(this).text()}else{try{f=e.unformat.call(r,e(this),{rowId:n,colModel:d[a]},a)}catch(l){f=d[a].edittype==="textarea"?e(this).text():e(this).html()}}if(i.p.autoencode){f=e.jgrid.htmlDecode(f)}if(t[i.p.id].checkOnSubmit===true||t[i.p.id].checkOnUpdate){t[i.p.id]._savedData[o]=f}o=e.jgrid.jqID(o);switch(d[a].edittype){case"password":case"text":case"button":case"image":case"textarea":if(f==="&nbsp;"||f==="&#160;"||f.length===1&&f.charCodeAt(0)===160){f=""}e("#"+o,"#"+s).val(f);break;case"select":var c=f.split(",");c=e.map(c,function(t){return e.trim(t)});e("#"+o+" option","#"+s).each(function(){if(!d[a].editoptions.multiple&&(e.trim(f)===e.trim(e(this).text())||c[0]===e.trim(e(this).text())||c[0]===e.trim(e(this).val()))){this.selected=true}else if(d[a].editoptions.multiple){if(e.inArray(e.trim(e(this).text()),c)>-1||e.inArray(e.trim(e(this).val()),c)>-1){this.selected=true}else{this.selected=false}}else{this.selected=false}});break;case"checkbox":f=String(f);if(d[a].editoptions&&d[a].editoptions.value){var h=d[a].editoptions.value.split(":");if(h[0]===f){e("#"+o,"#"+s)[i.p.useProp?"prop":"attr"]({checked:true,defaultChecked:true})}else{e("#"+o,"#"+s)[i.p.useProp?"prop":"attr"]({checked:false,defaultChecked:false})}}else{f=f.toLowerCase();if(f.search(/(false|f|0|no|n|off|undefined)/i)<0&&f!==""){e("#"+o,"#"+s)[i.p.useProp?"prop":"attr"]("checked",true);e("#"+o,"#"+s)[i.p.useProp?"prop":"attr"]("defaultChecked",true)}else{e("#"+o,"#"+s)[i.p.useProp?"prop":"attr"]("checked",false);e("#"+o,"#"+s)[i.p.useProp?"prop":"attr"]("defaultChecked",false)}}break;case"custom":try{if(d[a].editoptions&&e.isFunction(d[a].editoptions.custom_value)){d[a].editoptions.custom_value.call(i,e("#"+o,"#"+s),"set",f)}else{throw"e1"}}catch(p){if(p==="e1"){e.jgrid.info_dialog(e.jgrid.errors.errcap,"function 'custom_value' "+e.jgrid.edit.msg.nodefined,e.jgrid.edit.bClose)}else{e.jgrid.info_dialog(e.jgrid.errors.errcap,p.message,e.jgrid.edit.bClose)}}break}u++}});if(u>0){e("#id_g",a).val(n)}}function N(){e.each(i.p.colModel,function(e,t){if(t.editoptions&&t.editoptions.NullIfEmpty===true){if(y.hasOwnProperty(t.name)&&y[t.name]===""){y[t.name]="null"}}})}function C(){var n,u=[true,"",""],l={},c=i.p.prmNames,h,d,v,m,g;var b=e(i).triggerHandler("jqGridAddEditBeforeCheckValues",[e("#"+o),w]);if(b&&typeof b==="object"){y=b}if(e.isFunction(t[i.p.id].beforeCheckValues)){b=t[i.p.id].beforeCheckValues.call(i,y,e("#"+o),w);if(b&&typeof b==="object"){y=b}}for(v in y){if(y.hasOwnProperty(v)){u=e.jgrid.checkValues.call(i,y[v],v);if(u[0]===false){break}}}N();if(u[0]){l=e(i).triggerHandler("jqGridAddEditClickSubmit",[t[i.p.id],y,w]);if(l===undefined&&e.isFunction(t[i.p.id].onclickSubmit)){l=t[i.p.id].onclickSubmit.call(i,t[i.p.id],y,w)||{}}u=e(i).triggerHandler("jqGridAddEditBeforeSubmit",[y,e("#"+o),w]);if(u===undefined){u=[true,"",""]}if(u[0]&&e.isFunction(t[i.p.id].beforeSubmit)){u=t[i.p.id].beforeSubmit.call(i,y,e("#"+o),w)}}if(u[0]&&!t[i.p.id].processing){t[i.p.id].processing=true;e("#sData",a+"_2").addClass("ui-state-active");d=c.oper;h=c.id;y[d]=e.trim(y[i.p.id+"_id"])==="_empty"?c.addoper:c.editoper;if(y[d]!==c.addoper){y[h]=y[i.p.id+"_id"]}else{if(y[h]===undefined){y[h]=y[i.p.id+"_id"]}}delete y[i.p.id+"_id"];y=e.extend(y,t[i.p.id].editData,l);if(i.p.treeGrid===true){if(y[d]===c.addoper){m=e(i).jqGrid("getGridParam","selrow");var E=i.p.treeGridModel==="adjacency"?i.p.treeReader.parent_id_field:"parent_id";y[E]=m}for(g in i.p.treeReader){if(i.p.treeReader.hasOwnProperty(g)){var S=i.p.treeReader[g];if(y.hasOwnProperty(S)){if(y[d]===c.addoper&&g==="parent_id_field"){continue}delete y[S]}}}}y[h]=e.jgrid.stripPref(i.p.idPrefix,y[h]);var x=e.extend({url:t[i.p.id].url||e(i).jqGrid("getGridParam","editurl"),type:t[i.p.id].mtype,data:e.isFunction(t[i.p.id].serializeEditData)?t[i.p.id].serializeEditData.call(i,y):y,complete:function(l,v){var g;y[h]=i.p.idPrefix+y[h];if(l.status>=300&&l.status!==304){u[0]=false;u[1]=e(i).triggerHandler("jqGridAddEditErrorTextFormat",[l,w]);if(e.isFunction(t[i.p.id].errorTextFormat)){u[1]=t[i.p.id].errorTextFormat.call(i,l,w)}else{u[1]=v+" Status: '"+l.statusText+"'. Error code: "+l.status}}else{u=e(i).triggerHandler("jqGridAddEditAfterSubmit",[l,y,w]);if(u===undefined){u=[true,"",""]}if(u[0]&&e.isFunction(t[i.p.id].afterSubmit)){u=t[i.p.id].afterSubmit.call(i,l,y,w)}}if(u[0]===false){e("#FormError>td",a).html(u[1]);e("#FormError",a).show()}else{if(i.p.autoencode){e.each(y,function(t,n){y[t]=e.jgrid.htmlDecode(n)})}if(y[d]===c.addoper){if(!u[2]){u[2]=e.jgrid.randId()}y[h]=u[2];if(t[i.p.id].reloadAfterSubmit){e(i).trigger("reloadGrid")}else{if(i.p.treeGrid===true){e(i).jqGrid("addChildNode",u[2],m,y)}else{e(i).jqGrid("addRowData",u[2],y,r.addedrow)}}if(t[i.p.id].closeAfterAdd){if(i.p.treeGrid!==true){e(i).jqGrid("setSelection",u[2])}e.jgrid.hideModal("#"+e.jgrid.jqID(f.themodal),{gb:"#gbox_"+e.jgrid.jqID(s),jqm:r.jqModal,onClose:t[i.p.id].onClose})}else if(t[i.p.id].clearAfterAdd){T("_empty",i,o)}}else{if(t[i.p.id].reloadAfterSubmit){e(i).trigger("reloadGrid");if(!t[i.p.id].closeAfterEdit){setTimeout(function(){e(i).jqGrid("setSelection",y[h])},1e3)}}else{if(i.p.treeGrid===true){e(i).jqGrid("setTreeRow",y[h],y)}else{e(i).jqGrid("setRowData",y[h],y)}}if(t[i.p.id].closeAfterEdit){e.jgrid.hideModal("#"+e.jgrid.jqID(f.themodal),{gb:"#gbox_"+e.jgrid.jqID(s),jqm:r.jqModal,onClose:t[i.p.id].onClose})}}if(e.isFunction(t[i.p.id].afterComplete)){n=l;setTimeout(function(){e(i).triggerHandler("jqGridAddEditAfterComplete",[n,y,e("#"+o),w]);t[i.p.id].afterComplete.call(i,n,y,e("#"+o),w);n=null},500)}if(t[i.p.id].checkOnSubmit||t[i.p.id].checkOnUpdate){e("#"+o).data("disabled",false);if(t[i.p.id]._savedData[i.p.id+"_id"]!=="_empty"){for(g in t[i.p.id]._savedData){if(t[i.p.id]._savedData.hasOwnProperty(g)&&y[g]){t[i.p.id]._savedData[g]=y[g]}}}}}t[i.p.id].processing=false;e("#sData",a+"_2").removeClass("ui-state-active");try{e(":input:visible","#"+o)[0].focus()}catch(b){}}},e.jgrid.ajaxOptions,t[i.p.id].ajaxEditOptions);if(!x.url&&!t[i.p.id].useDataProxy){if(e.isFunction(i.p.dataProxy)){t[i.p.id].useDataProxy=true}else{u[0]=false;u[1]+=" "+e.jgrid.errors.nourl}}if(u[0]){if(t[i.p.id].useDataProxy){var C=i.p.dataProxy.call(i,x,"set_"+i.p.id);if(C===undefined){C=[true,""]}if(C[0]===false){u[0]=false;u[1]=C[1]||"Error deleting the selected row!"}else{if(x.data.oper===c.addoper&&t[i.p.id].closeAfterAdd){e.jgrid.hideModal("#"+e.jgrid.jqID(f.themodal),{gb:"#gbox_"+e.jgrid.jqID(s),jqm:r.jqModal,onClose:t[i.p.id].onClose})}if(x.data.oper===c.editoper&&t[i.p.id].closeAfterEdit){e.jgrid.hideModal("#"+e.jgrid.jqID(f.themodal),{gb:"#gbox_"+e.jgrid.jqID(s),jqm:r.jqModal,onClose:t[i.p.id].onClose})}}}else{e.ajax(x)}}}if(u[0]===false){e("#FormError>td",a).html(u[1]);e("#FormError",a).show()}}function k(e,t){var n=false,r;for(r in e){if(e.hasOwnProperty(r)&&e[r]!=t[r]){n=true;break}}return n}function L(){var n=true;e("#FormError",a).hide();if(t[i.p.id].checkOnUpdate){y={};S();b=k(y,t[i.p.id]._savedData);if(b){e("#"+o).data("disabled",true);e(".confirm","#"+f.themodal).show();n=false}}return n}function A(){var t;if(n!=="_empty"&&i.p.savedRow!==undefined&&i.p.savedRow.length>0&&e.isFunction(e.fn.jqGrid.restoreRow)){for(t=0;t<i.p.savedRow.length;t++){if(i.p.savedRow[t].id==n){e(i).jqGrid("restoreRow",n);break}}}}function O(t,n){var r=n[1].length-1;if(t===0){e("#pData",a+"_2").addClass("ui-state-disabled")}else if(n[1][t-1]!==undefined&&e("#"+e.jgrid.jqID(n[1][t-1])).hasClass("ui-state-disabled")){e("#pData",a+"_2").addClass("ui-state-disabled")}else{e("#pData",a+"_2").removeClass("ui-state-disabled")}if(t===r){e("#nData",a+"_2").addClass("ui-state-disabled")}else if(n[1][t+1]!==undefined&&e("#"+e.jgrid.jqID(n[1][t+1])).hasClass("ui-state-disabled")){e("#nData",a+"_2").addClass("ui-state-disabled")}else{e("#nData",a+"_2").removeClass("ui-state-disabled")}}function M(){var t=e(i).jqGrid("getDataIDs"),n=e("#id_g",a).val(),r=e.inArray(n,t);return[r,t]}var i=this;if(!i.grid||!n){return}var s=i.p.id,o="FrmGrid_"+s,u="TblGrid_"+s,a="#"+e.jgrid.jqID(u),f={themodal:"editmod"+s,modalhead:"edithd"+s,modalcontent:"editcnt"+s,scrollelm:o},l=e.isFunction(t[i.p.id].beforeShowForm)?t[i.p.id].beforeShowForm:false,c=e.isFunction(t[i.p.id].afterShowForm)?t[i.p.id].afterShowForm:false,h=e.isFunction(t[i.p.id].beforeInitData)?t[i.p.id].beforeInitData:false,d=e.isFunction(t[i.p.id].onInitializeForm)?t[i.p.id].onInitializeForm:false,v=true,m=1,g=0,y,b,w;o=e.jgrid.jqID(o);if(n==="new"){n="_empty";w="add";r.caption=t[i.p.id].addCaption}else{r.caption=t[i.p.id].editCaption;w="edit"}if(!r.recreateForm){if(e(i).data("formProp")){e.extend(t[e(this)[0].p.id],e(i).data("formProp"))}}var E=true;if(r.checkOnUpdate&&r.jqModal&&!r.modal){E=false}var _=isNaN(t[e(this)[0].p.id].dataheight)?t[e(this)[0].p.id].dataheight:t[e(this)[0].p.id].dataheight+"px",D=isNaN(t[e(this)[0].p.id].datawidth)?t[e(this)[0].p.id].datawidth:t[e(this)[0].p.id].datawidth+"px",P=e("<form name='FormPost' id='"+o+"' class='FormGrid' onSubmit='return false;' style='width:"+D+";overflow:auto;position:relative;height:"+_+";'></form>").data("disabled",false),H=e("<table id='"+u+"' class='EditTable' cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>");v=e(i).triggerHandler("jqGridAddEditBeforeInitData",[e("#"+o),w]);if(v===undefined){v=true}if(v&&h){v=h.call(i,e("#"+o),w)}if(v===false){return}A();e(i.p.colModel).each(function(){var e=this.formoptions;m=Math.max(m,e?e.colpos||0:0);g=Math.max(g,e?e.rowpos||0:0)});e(P).append(H);var B=e("<tr id='FormError' style='display:none'><td class='ui-state-error' colspan='"+m*2+"'></td></tr>");B[0].rp=0;e(H).append(B);B=e("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+m*2+"'>"+t[i.p.id].topinfo+"</td></tr>");B[0].rp=0;e(H).append(B);var j=i.p.direction==="rtl"?true:false,F=j?"nData":"pData",I=j?"pData":"nData";x(n,i,H,m);var q="<a id='"+F+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>",R="<a id='"+I+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",U="<a id='sData' class='fm-button ui-state-default ui-corner-all'>"+r.bSubmit+"</a>",z="<a id='cData' class='fm-button ui-state-default ui-corner-all'>"+r.bCancel+"</a>";var W="<table border='0' cellspacing='0' cellpadding='0' class='EditTable' id='"+u+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton'>"+(j?R+q:q+R)+"</td><td class='EditButton'>"+U+z+"</td></tr>";W+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+t[i.p.id].bottominfo+"</td></tr>";W+="</tbody></table>";if(g>0){var X=[];e.each(e(H)[0].rows,function(e,t){X[e]=t});X.sort(function(e,t){if(e.rp>t.rp){return 1}if(e.rp<t.rp){return-1}return 0});e.each(X,function(t,n){e("tbody",H).append(n)})}r.gbox="#gbox_"+e.jgrid.jqID(s);var V=false;if(r.closeOnEscape===true){r.closeOnEscape=false;V=true}var J=e("<div></div>").append(P).append(W);e.jgrid.createModal(f,J,t[e(this)[0].p.id],"#gview_"+e.jgrid.jqID(i.p.id),e("#gbox_"+e.jgrid.jqID(i.p.id))[0]);if(j){e("#pData, #nData",a+"_2").css("float","right");e(".EditButton",a+"_2").css("text-align","left")}if(t[i.p.id].topinfo){e(".tinfo",a).show()}if(t[i.p.id].bottominfo){e(".binfo",a+"_2").show()}J=null;W=null;e("#"+e.jgrid.jqID(f.themodal)).keydown(function(n){var s=n.target;if(e("#"+o).data("disabled")===true){return false}if(t[i.p.id].savekey[0]===true&&n.which===t[i.p.id].savekey[1]){if(s.tagName!=="TEXTAREA"){e("#sData",a+"_2").trigger("click");return false}}if(n.which===27){if(!L()){return false}if(V){e.jgrid.hideModal("#"+e.jgrid.jqID(f.themodal),{gb:r.gbox,jqm:r.jqModal,onClose:t[i.p.id].onClose})}return false}if(t[i.p.id].navkeys[0]===true){if(e("#id_g",a).val()==="_empty"){return true}if(n.which===t[i.p.id].navkeys[1]){e("#pData",a+"_2").trigger("click");return false}if(n.which===t[i.p.id].navkeys[2]){e("#nData",a+"_2").trigger("click");return false}}});if(r.checkOnUpdate){e("a.ui-jqdialog-titlebar-close span","#"+e.jgrid.jqID(f.themodal)).removeClass("jqmClose");e("a.ui-jqdialog-titlebar-close","#"+e.jgrid.jqID(f.themodal)).unbind("click").click(function(){if(!L()){return false}e.jgrid.hideModal("#"+e.jgrid.jqID(f.themodal),{gb:"#gbox_"+e.jgrid.jqID(s),jqm:r.jqModal,onClose:t[i.p.id].onClose});return false})}r.saveicon=e.extend([true,"left","ui-icon-disk"],r.saveicon);r.closeicon=e.extend([true,"left","ui-icon-close"],r.closeicon);if(r.saveicon[0]===true){e("#sData",a+"_2").addClass(r.saveicon[1]==="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+r.saveicon[2]+"'></span>")}if(r.closeicon[0]===true){e("#cData",a+"_2").addClass(r.closeicon[1]==="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+r.closeicon[2]+"'></span>")}if(t[i.p.id].checkOnSubmit||t[i.p.id].checkOnUpdate){U="<a id='sNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+r.bYes+"</a>";R="<a id='nNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+r.bNo+"</a>";z="<a id='cNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+r.bExit+"</a>";var K=r.zIndex||999;K++;e("<div class='"+r.overlayClass+" jqgrid-overlay confirm' style='z-index:"+K+";display:none;'>&#160;"+"</div><div class='confirm ui-widget-content ui-jqconfirm' style='z-index:"+(K+1)+"'>"+r.saveData+"<br/><br/>"+U+R+z+"</div>").insertAfter("#"+o);e("#sNew","#"+e.jgrid.jqID(f.themodal)).click(function(){C();e("#"+o).data("disabled",false);e(".confirm","#"+e.jgrid.jqID(f.themodal)).hide();return false});e("#nNew","#"+e.jgrid.jqID(f.themodal)).click(function(){e(".confirm","#"+e.jgrid.jqID(f.themodal)).hide();e("#"+o).data("disabled",false);setTimeout(function(){e(":input:visible","#"+o)[0].focus()},0);return false});e("#cNew","#"+e.jgrid.jqID(f.themodal)).click(function(){e(".confirm","#"+e.jgrid.jqID(f.themodal)).hide();e("#"+o).data("disabled",false);e.jgrid.hideModal("#"+e.jgrid.jqID(f.themodal),{gb:"#gbox_"+e.jgrid.jqID(s),jqm:r.jqModal,onClose:t[i.p.id].onClose});return false})}e(i).triggerHandler("jqGridAddEditInitializeForm",[e("#"+o),w]);if(d){d.call(i,e("#"+o),w)}if(n==="_empty"||!t[i.p.id].viewPagerButtons){e("#pData,#nData",a+"_2").hide()}else{e("#pData,#nData",a+"_2").show()}e(i).triggerHandler("jqGridAddEditBeforeShowForm",[e("#"+o),w]);if(l){l.call(i,e("#"+o),w)}e("#"+e.jgrid.jqID(f.themodal)).data("onClose",t[i.p.id].onClose);e.jgrid.viewModal("#"+e.jgrid.jqID(f.themodal),{gbox:"#gbox_"+e.jgrid.jqID(s),jqm:r.jqModal,overlay:r.overlay,modal:r.modal,overlayClass:r.overlayClass,onHide:function(t){e(i).data("formProp",{top:parseFloat(e(t.w).css("top")),left:parseFloat(e(t.w).css("left")),width:e(t.w).width(),height:e(t.w).height(),dataheight:e("#"+o).height(),datawidth:e("#"+o).width()});t.w.remove();if(t.o){t.o.remove()}}});if(!E){e("."+e.jgrid.jqID(r.overlayClass)).click(function(){if(!L()){return false}e.jgrid.hideModal("#"+e.jgrid.jqID(f.themodal),{gb:"#gbox_"+e.jgrid.jqID(s),jqm:r.jqModal,onClose:t[i.p.id].onClose});return false})}e(".fm-button","#"+e.jgrid.jqID(f.themodal)).hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")});e("#sData",a+"_2").click(function(){y={};e("#FormError",a).hide();S();if(y[i.p.id+"_id"]==="_empty"){C()}else if(r.checkOnSubmit===true){b=k(y,t[i.p.id]._savedData);if(b){e("#"+o).data("disabled",true);e(".confirm","#"+e.jgrid.jqID(f.themodal)).show()}else{C()}}else{C()}return false});e("#cData",a+"_2").click(function(){if(!L()){return false}e.jgrid.hideModal("#"+e.jgrid.jqID(f.themodal),{gb:"#gbox_"+e.jgrid.jqID(s),jqm:r.jqModal,onClose:t[i.p.id].onClose});return false});e("#nData",a+"_2").click(function(){if(!L()){return false}e("#FormError",a).hide();var t=M();t[0]=parseInt(t[0],10);if(t[0]!==-1&&t[1][t[0]+1]){e(i).triggerHandler("jqGridAddEditClickPgButtons",["next",e("#"+o),t[1][t[0]]]);var n;if(e.isFunction(r.onclickPgButtons)){n=r.onclickPgButtons.call(i,"next",e("#"+o),t[1][t[0]]);if(n!==undefined&&n===false){return false}}if(e("#"+e.jgrid.jqID(t[1][t[0]+1])).hasClass("ui-state-disabled")){return false}T(t[1][t[0]+1],i,o);e(i).jqGrid("setSelection",t[1][t[0]+1]);e(i).triggerHandler("jqGridAddEditAfterClickPgButtons",["next",e("#"+o),t[1][t[0]]]);if(e.isFunction(r.afterclickPgButtons)){r.afterclickPgButtons.call(i,"next",e("#"+o),t[1][t[0]+1])}O(t[0]+1,t)}return false});e("#pData",a+"_2").click(function(){if(!L()){return false}e("#FormError",a).hide();var t=M();if(t[0]!==-1&&t[1][t[0]-1]){e(i).triggerHandler("jqGridAddEditClickPgButtons",["prev",e("#"+o),t[1][t[0]]]);var n;if(e.isFunction(r.onclickPgButtons)){n=r.onclickPgButtons.call(i,"prev",e("#"+o),t[1][t[0]]);if(n!==undefined&&n===false){return false}}if(e("#"+e.jgrid.jqID(t[1][t[0]-1])).hasClass("ui-state-disabled")){return false}T(t[1][t[0]-1],i,o);e(i).jqGrid("setSelection",t[1][t[0]-1]);e(i).triggerHandler("jqGridAddEditAfterClickPgButtons",["prev",e("#"+o),t[1][t[0]]]);if(e.isFunction(r.afterclickPgButtons)){r.afterclickPgButtons.call(i,"prev",e("#"+o),t[1][t[0]-1])}O(t[0]-1,t)}return false});e(i).triggerHandler("jqGridAddEditAfterShowForm",[e("#"+o),w]);if(c){c.call(i,e("#"+o),w)}var Q=M();O(Q[0],Q)})},viewGridRow:function(n,r){r=e.extend(true,{top:0,left:0,width:0,datawidth:"auto",height:"auto",dataheight:"auto",modal:false,overlay:30,drag:true,resize:true,jqModal:true,closeOnEscape:false,labelswidth:"30%",closeicon:[],navkeys:[false,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:true,recreateForm:false},e.jgrid.view,r||{});t[e(this)[0].p.id]=r;return this.each(function(){function m(){if(t[i.p.id].closeOnEscape===true||t[i.p.id].navkeys[0]===true){setTimeout(function(){e(".ui-jqdialog-titlebar-close","#"+e.jgrid.jqID(l.modalhead)).focus()},0)}}function g(t,n,i,s){var o,u,a,f=0,l,c,h=[],d=false,v,m="<td class='CaptionTD form-view-label ui-widget-content' width='"+r.labelswidth+"'>&#160;</td><td class='DataTD form-view-data ui-helper-reset ui-widget-content'>&#160;</td>",g="",y="<td class='CaptionTD form-view-label ui-widget-content'>&#160;</td><td class='DataTD form-view-data ui-widget-content'>&#160;</td>",b=["integer","number","currency"],w=0,E=0,S,x,T;for(v=1;v<=s;v++){g+=v===1?m:y}e(n.p.colModel).each(function(){if(this.editrules&&this.editrules.edithidden===true){u=false}else{u=this.hidden===true?true:false}if(!u&&this.align==="right"){if(this.formatter&&e.inArray(this.formatter,b)!==-1){w=Math.max(w,parseInt(this.width,10))}else{E=Math.max(E,parseInt(this.width,10))}}});S=w!==0?w:E!==0?E:0;d=e(n).jqGrid("getInd",t);e(n.p.colModel).each(function(t){o=this.name;x=false;if(this.editrules&&this.editrules.edithidden===true){u=false}else{u=this.hidden===true?true:false}c=u?"style='display:none'":"";T=typeof this.viewable!=="boolean"?true:this.viewable;if(o!=="cb"&&o!=="subgrid"&&o!=="rn"&&T){if(d===false){l=""}else{if(o===n.p.ExpandColumn&&n.p.treeGrid===true){l=e("td:eq("+t+")",n.rows[d]).text()}else{l=e("td:eq("+t+")",n.rows[d]).html()}}x=this.align==="right"&&S!==0?true:false;var r=e.extend({},{rowabove:false,rowcontent:""},this.formoptions||{}),p=parseInt(r.rowpos,10)||f+1,v=parseInt((parseInt(r.colpos,10)||1)*2,10);if(r.rowabove){var m=e("<tr><td class='contentinfo' colspan='"+s*2+"'>"+r.rowcontent+"</td></tr>");e(i).append(m);m[0].rp=p}a=e(i).find("tr[rowpos="+p+"]");if(a.length===0){a=e("<tr "+c+" rowpos='"+p+"'></tr>").addClass("FormData").attr("id","trv_"+o);e(a).append(g);e(i).append(a);a[0].rp=p}e("td:eq("+(v-2)+")",a[0]).html("<b>"+(r.label===undefined?n.p.colNames[t]:r.label)+"</b>");e("td:eq("+(v-1)+")",a[0]).append("<span>"+l+"</span>").attr("id","v_"+o);if(x){e("td:eq("+(v-1)+") span",a[0]).css({"text-align":"right",width:S+"px"})}h[f]=t;f++}});if(f>0){var N=e("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(s*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+t+"'/></td></tr>");N[0].rp=f+99;e(i).append(N)}return h}function y(t,n){var r,i,s=0,o,a;a=e(n).jqGrid("getInd",t,true);if(!a){return}e("td",a).each(function(t){r=n.p.colModel[t].name;if(n.p.colModel[t].editrules&&n.p.colModel[t].editrules.edithidden===true){i=false}else{i=n.p.colModel[t].hidden===true?true:false}if(r!=="cb"&&r!=="subgrid"&&r!=="rn"){if(r===n.p.ExpandColumn&&n.p.treeGrid===true){o=e(this).text()}else{o=e(this).html()}r=e.jgrid.jqID("v_"+r);e("#"+r+" span","#"+u).html(o);if(i){e("#"+r,"#"+u).parents("tr:first").hide()}s++}});if(s>0){e("#id_g","#"+u).val(t)}}function b(t,n){var r=n[1].length-1;if(t===0){e("#pData","#"+u+"_2").addClass("ui-state-disabled")}else if(n[1][t-1]!==undefined&&e("#"+e.jgrid.jqID(n[1][t-1])).hasClass("ui-state-disabled")){e("#pData",u+"_2").addClass("ui-state-disabled")}else{e("#pData","#"+u+"_2").removeClass("ui-state-disabled")}if(t===r){e("#nData","#"+u+"_2").addClass("ui-state-disabled")}else if(n[1][t+1]!==undefined&&e("#"+e.jgrid.jqID(n[1][t+1])).hasClass("ui-state-disabled")){e("#nData",u+"_2").addClass("ui-state-disabled")}else{e("#nData","#"+u+"_2").removeClass("ui-state-disabled")}}function w(){var t=e(i).jqGrid("getDataIDs"),n=e("#id_g","#"+u).val(),r=e.inArray(n,t);return[r,t]}var i=this;if(!i.grid||!n){return}var s=i.p.id,o="ViewGrid_"+e.jgrid.jqID(s),u="ViewTbl_"+e.jgrid.jqID(s),a="ViewGrid_"+s,f="ViewTbl_"+s,l={themodal:"viewmod"+s,modalhead:"viewhd"+s,modalcontent:"viewcnt"+s,scrollelm:o},c=e.isFunction(t[i.p.id].beforeInitData)?t[i.p.id].beforeInitData:false,h=true,d=1,v=0;if(!r.recreateForm){if(e(i).data("viewProp")){e.extend(t[e(this)[0].p.id],e(i).data("viewProp"))}}var E=isNaN(t[e(this)[0].p.id].dataheight)?t[e(this)[0].p.id].dataheight:t[e(this)[0].p.id].dataheight+"px",S=isNaN(t[e(this)[0].p.id].datawidth)?t[e(this)[0].p.id].datawidth:t[e(this)[0].p.id].datawidth+"px",x=e("<form name='FormPost' id='"+a+"' class='FormGrid' style='width:"+S+";overflow:auto;position:relative;height:"+E+";'></form>"),T=e("<table id='"+f+"' class='EditTable' cellspacing='1' cellpadding='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");if(c){h=c.call(i,e("#"+o));if(h===undefined){h=true}}if(h===false){return}e(i.p.colModel).each(function(){var e=this.formoptions;d=Math.max(d,e?e.colpos||0:0);v=Math.max(v,e?e.rowpos||0:0)});e(x).append(T);g(n,i,T,d);var N=i.p.direction==="rtl"?true:false,C=N?"nData":"pData",k=N?"pData":"nData",L="<a id='"+C+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>",A="<a id='"+k+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",O="<a id='cData' class='fm-button ui-state-default ui-corner-all'>"+r.bClose+"</a>";if(v>0){var M=[];e.each(e(T)[0].rows,function(e,t){M[e]=t});M.sort(function(e,t){if(e.rp>t.rp){return 1}if(e.rp<t.rp){return-1}return 0});e.each(M,function(t,n){e("tbody",T).append(n)})}r.gbox="#gbox_"+e.jgrid.jqID(s);var _=e("<div></div>").append(x).append("<table border='0' class='EditTable' id='"+u+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+r.labelswidth+"'>"+(N?A+L:L+A)+"</td><td class='EditButton'>"+O+"</td></tr></tbody></table>");e.jgrid.createModal(l,_,r,"#gview_"+e.jgrid.jqID(i.p.id),e("#gview_"+e.jgrid.jqID(i.p.id))[0]);if(N){e("#pData, #nData","#"+u+"_2").css("float","right");e(".EditButton","#"+u+"_2").css("text-align","left")}if(!r.viewPagerButtons){e("#pData, #nData","#"+u+"_2").hide()}_=null;e("#"+l.themodal).keydown(function(n){if(n.which===27){if(t[i.p.id].closeOnEscape){e.jgrid.hideModal("#"+e.jgrid.jqID(l.themodal),{gb:r.gbox,jqm:r.jqModal,onClose:r.onClose})}return false}if(r.navkeys[0]===true){if(n.which===r.navkeys[1]){e("#pData","#"+u+"_2").trigger("click");return false}if(n.which===r.navkeys[2]){e("#nData","#"+u+"_2").trigger("click");return false}}});r.closeicon=e.extend([true,"left","ui-icon-close"],r.closeicon);if(r.closeicon[0]===true){e("#cData","#"+u+"_2").addClass(r.closeicon[1]==="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+r.closeicon[2]+"'></span>")}if(e.isFunction(r.beforeShowForm)){r.beforeShowForm.call(i,e("#"+o))}e.jgrid.viewModal("#"+e.jgrid.jqID(l.themodal),{gbox:"#gbox_"+e.jgrid.jqID(s),jqm:r.jqModal,overlay:r.overlay,modal:r.modal,onHide:function(t){e(i).data("viewProp",{top:parseFloat(e(t.w).css("top")),left:parseFloat(e(t.w).css("left")),width:e(t.w).width(),height:e(t.w).height(),dataheight:e("#"+o).height(),datawidth:e("#"+o).width()});t.w.remove();if(t.o){t.o.remove()}}});e(".fm-button:not(.ui-state-disabled)","#"+u+"_2").hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")});m();e("#cData","#"+u+"_2").click(function(){e.jgrid.hideModal("#"+e.jgrid.jqID(l.themodal),{gb:"#gbox_"+e.jgrid.jqID(s),jqm:r.jqModal,onClose:r.onClose});return false});e("#nData","#"+u+"_2").click(function(){e("#FormError","#"+u).hide();var t=w();t[0]=parseInt(t[0],10);if(t[0]!==-1&&t[1][t[0]+1]){if(e.isFunction(r.onclickPgButtons)){r.onclickPgButtons.call(i,"next",e("#"+o),t[1][t[0]])}y(t[1][t[0]+1],i);e(i).jqGrid("setSelection",t[1][t[0]+1]);if(e.isFunction(r.afterclickPgButtons)){r.afterclickPgButtons.call(i,"next",e("#"+o),t[1][t[0]+1])}b(t[0]+1,t)}m();return false});e("#pData","#"+u+"_2").click(function(){e("#FormError","#"+u).hide();var t=w();if(t[0]!==-1&&t[1][t[0]-1]){if(e.isFunction(r.onclickPgButtons)){r.onclickPgButtons.call(i,"prev",e("#"+o),t[1][t[0]])}y(t[1][t[0]-1],i);e(i).jqGrid("setSelection",t[1][t[0]-1]);if(e.isFunction(r.afterclickPgButtons)){r.afterclickPgButtons.call(i,"prev",e("#"+o),t[1][t[0]-1])}b(t[0]-1,t)}m();return false});var D=w();b(D[0],D)})},delGridRow:function(n,r){r=e.extend(true,{top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:false,overlay:30,drag:true,resize:true,url:"",mtype:"POST",reloadAfterSubmit:true,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:true,closeOnEscape:false,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:false,serializeDelData:null,useDataProxy:false},e.jgrid.del,r||{});t[e(this)[0].p.id]=r;return this.each(function(){var i=this;if(!i.grid){return}if(!n){return}var s=e.isFunction(t[i.p.id].beforeShowForm),o=e.isFunction(t[i.p.id].afterShowForm),u=e.isFunction(t[i.p.id].beforeInitData)?t[i.p.id].beforeInitData:false,a=i.p.id,f={},l=true,c="DelTbl_"+e.jgrid.jqID(a),h,d,v,m,g="DelTbl_"+a,y={themodal:"delmod"+a,modalhead:"delhd"+a,modalcontent:"delcnt"+a,scrollelm:c};if(e.isArray(n)){n=n.join()}if(e("#"+e.jgrid.jqID(y.themodal))[0]!==undefined){if(u){l=u.call(i,e("#"+c));if(l===undefined){l=true}}if(l===false){return}e("#DelData>td","#"+c).text(n);e("#DelError","#"+c).hide();if(t[i.p.id].processing===true){t[i.p.id].processing=false;e("#dData","#"+c).removeClass("ui-state-active")}if(s){t[i.p.id].beforeShowForm.call(i,e("#"+c))}e.jgrid.viewModal("#"+e.jgrid.jqID(y.themodal),{gbox:"#gbox_"+e.jgrid.jqID(a),jqm:t[i.p.id].jqModal,jqM:false,overlay:t[i.p.id].overlay,modal:t[i.p.id].modal});if(o){t[i.p.id].afterShowForm.call(i,e("#"+c))}}else{var b=isNaN(t[i.p.id].dataheight)?t[i.p.id].dataheight:t[i.p.id].dataheight+"px",w=isNaN(r.datawidth)?r.datawidth:r.datawidth+"px",E="<div id='"+g+"' class='formdata' style='width:"+w+";overflow:auto;position:relative;height:"+b+";'>";E+="<table class='DelTable'><tbody>";E+="<tr id='DelError' style='display:none'><td class='ui-state-error'></td></tr>";E+="<tr id='DelData' style='display:none'><td >"+n+"</td></tr>";E+='<tr><td class="delmsg" style="white-space:pre;">'+t[i.p.id].msg+"</td></tr><tr><td >&#160;</td></tr>";E+="</tbody></table></div>";var S="<a id='dData' class='fm-button ui-state-default ui-corner-all'>"+r.bSubmit+"</a>",x="<a id='eData' class='fm-button ui-state-default ui-corner-all'>"+r.bCancel+"</a>";E+="<table cellspacing='0' cellpadding='0' border='0' class='EditTable' id='"+c+"_2'><tbody><tr><td><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton'>"+S+"&#160;"+x+"</td></tr></tbody></table>";r.gbox="#gbox_"+e.jgrid.jqID(a);e.jgrid.createModal(y,E,r,"#gview_"+e.jgrid.jqID(i.p.id),e("#gview_"+e.jgrid.jqID(i.p.id))[0]);if(u){l=u.call(i,e("#"+c));if(l===undefined){l=true}}if(l===false){return}e(".fm-button","#"+c+"_2").hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")});r.delicon=e.extend([true,"left","ui-icon-scissors"],t[i.p.id].delicon);r.cancelicon=e.extend([true,"left","ui-icon-cancel"],t[i.p.id].cancelicon);if(r.delicon[0]===true){e("#dData","#"+c+"_2").addClass(r.delicon[1]==="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+r.delicon[2]+"'></span>")}if(r.cancelicon[0]===true){e("#eData","#"+c+"_2").addClass(r.cancelicon[1]==="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+r.cancelicon[2]+"'></span>")}e("#dData","#"+c+"_2").click(function(){var n=[true,""],s,o=e("#DelData>td","#"+c).text();f={};if(e.isFunction(t[i.p.id].onclickSubmit)){f=t[i.p.id].onclickSubmit.call(i,t[i.p.id],o)||{}}if(e.isFunction(t[i.p.id].beforeSubmit)){n=t[i.p.id].beforeSubmit.call(i,o)}if(n[0]&&!t[i.p.id].processing){t[i.p.id].processing=true;v=i.p.prmNames;h=e.extend({},t[i.p.id].delData,f);m=v.oper;h[m]=v.deloper;d=v.id;o=String(o).split(",");if(!o.length){return false}for(s in o){if(o.hasOwnProperty(s)){o[s]=e.jgrid.stripPref(i.p.idPrefix,o[s])}}h[d]=o.join();e(this).addClass("ui-state-active");var u=e.extend({url:t[i.p.id].url||e(i).jqGrid("getGridParam","editurl"),type:t[i.p.id].mtype,data:e.isFunction(t[i.p.id].serializeDelData)?t[i.p.id].serializeDelData.call(i,h):h,complete:function(s,u){var f;if(s.status>=300&&s.status!==304){n[0]=false;if(e.isFunction(t[i.p.id].errorTextFormat)){n[1]=t[i.p.id].errorTextFormat.call(i,s)}else{n[1]=u+" Status: '"+s.statusText+"'. Error code: "+s.status}}else{if(e.isFunction(t[i.p.id].afterSubmit)){n=t[i.p.id].afterSubmit.call(i,s,h)}}if(n[0]===false){e("#DelError>td","#"+c).html(n[1]);e("#DelError","#"+c).show()}else{if(t[i.p.id].reloadAfterSubmit&&i.p.datatype!=="local"){e(i).trigger("reloadGrid")}else{if(i.p.treeGrid===true){try{e(i).jqGrid("delTreeNode",i.p.idPrefix+o[0])}catch(l){}}else{for(f=0;f<o.length;f++){e(i).jqGrid("delRowData",i.p.idPrefix+o[f])}}i.p.selrow=null;i.p.selarrrow=[]}if(e.isFunction(t[i.p.id].afterComplete)){setTimeout(function(){t[i.p.id].afterComplete.call(i,s,o)},500)}}t[i.p.id].processing=false;e("#dData","#"+c+"_2").removeClass("ui-state-active");if(n[0]){e.jgrid.hideModal("#"+e.jgrid.jqID(y.themodal),{gb:"#gbox_"+e.jgrid.jqID(a),jqm:r.jqModal,onClose:t[i.p.id].onClose})}}},e.jgrid.ajaxOptions,t[i.p.id].ajaxDelOptions);if(!u.url&&!t[i.p.id].useDataProxy){if(e.isFunction(i.p.dataProxy)){t[i.p.id].useDataProxy=true}else{n[0]=false;n[1]+=" "+e.jgrid.errors.nourl}}if(n[0]){if(t[i.p.id].useDataProxy){var l=i.p.dataProxy.call(i,u,"del_"+i.p.id);if(l===undefined){l=[true,""]}if(l[0]===false){n[0]=false;n[1]=l[1]||"Error deleting the selected row!"}else{e.jgrid.hideModal("#"+e.jgrid.jqID(y.themodal),{gb:"#gbox_"+e.jgrid.jqID(a),jqm:r.jqModal,onClose:t[i.p.id].onClose})}}else{e.ajax(u)}}}if(n[0]===false){e("#DelError>td","#"+c).html(n[1]);e("#DelError","#"+c).show()}return false});e("#eData","#"+c+"_2").click(function(){e.jgrid.hideModal("#"+e.jgrid.jqID(y.themodal),{gb:"#gbox_"+e.jgrid.jqID(a),jqm:t[i.p.id].jqModal,onClose:t[i.p.id].onClose});return false});if(s){t[i.p.id].beforeShowForm.call(i,e("#"+c))}e.jgrid.viewModal("#"+e.jgrid.jqID(y.themodal),{gbox:"#gbox_"+e.jgrid.jqID(a),jqm:t[i.p.id].jqModal,overlay:t[i.p.id].overlay,modal:t[i.p.id].modal});if(o){t[i.p.id].afterShowForm.call(i,e("#"+c))}}if(t[i.p.id].closeOnEscape===true){setTimeout(function(){e(".ui-jqdialog-titlebar-close","#"+e.jgrid.jqID(y.modalhead)).focus()},0)}})},navGrid:function(t,n,r,i,s,o,u){n=e.extend({edit:true,editicon:"ui-icon-pencil",add:true,addicon:"ui-icon-plus",del:true,delicon:"ui-icon-trash",search:true,searchicon:"ui-icon-search",refresh:true,refreshicon:"ui-icon-refresh",refreshstate:"firstpage",view:false,viewicon:"ui-icon-document",position:"left",closeOnEscape:true,beforeRefresh:null,afterRefresh:null,cloneToTop:false,alertwidth:200,alertheight:"auto",alerttop:null,alertleft:null,alertzIndex:null},e.jgrid.nav,n||{});return this.each(function(){if(this.nav){return}var a={themodal:"alertmod_"+this.p.id,modalhead:"alerthd_"+this.p.id,modalcontent:"alertcnt_"+this.p.id},f=this,l,c;if(!f.grid||typeof t!=="string"){return}if(e("#"+a.themodal)[0]===undefined){if(!n.alerttop&&!n.alertleft){if(window.innerWidth!==undefined){n.alertleft=window.innerWidth;n.alerttop=window.innerHeight}else if(document.documentElement!==undefined&&document.documentElement.clientWidth!==undefined&&document.documentElement.clientWidth!==0){n.alertleft=document.documentElement.clientWidth;n.alerttop=document.documentElement.clientHeight}else{n.alertleft=1024;n.alerttop=768}n.alertleft=n.alertleft/2-parseInt(n.alertwidth,10)/2;n.alerttop=n.alerttop/2-25}e.jgrid.createModal(a,"<div>"+n.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",{gbox:"#gbox_"+e.jgrid.jqID(f.p.id),jqModal:true,drag:true,resize:true,caption:n.alertcap,top:n.alerttop,left:n.alertleft,width:n.alertwidth,height:n.alertheight,closeOnEscape:n.closeOnEscape,zIndex:n.alertzIndex},"#gview_"+e.jgrid.jqID(f.p.id),e("#gbox_"+e.jgrid.jqID(f.p.id))[0],true)}var h=1,p,d=function(){if(!e(this).hasClass("ui-state-disabled")){e(this).addClass("ui-state-hover")}},v=function(){e(this).removeClass("ui-state-hover")};if(n.cloneToTop&&f.p.toppager){h=2}for(p=0;p<h;p++){var m,g=e("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr></tr></tbody></table>"),y="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>",b,w;if(p===0){b=t;w=f.p.id;if(b===f.p.toppager){w+="_top";h=1}}else{b=f.p.toppager;w=f.p.id+"_top"}if(f.p.direction==="rtl"){e(g).attr("dir","rtl").css("float","right")}if(n.add){i=i||{};m=e("<td class='ui-pg-button ui-corner-all'></td>");e(m).append("<div class='ui-pg-div'><span class='ui-icon "+n.addicon+"'></span>"+n.addtext+"</div>");e("tr",g).append(m);e(m,g).attr({title:n.addtitle||"",id:i.id||"add_"+w}).click(function(){if(!e(this).hasClass("ui-state-disabled")){if(e.isFunction(n.addfunc)){n.addfunc.call(f)}else{e(f).jqGrid("editGridRow","new",i)}}return false}).hover(d,v);m=null}if(n.edit){m=e("<td class='ui-pg-button ui-corner-all'></td>");r=r||{};e(m).append("<div class='ui-pg-div'><span class='ui-icon "+n.editicon+"'></span>"+n.edittext+"</div>");e("tr",g).append(m);e(m,g).attr({title:n.edittitle||"",id:r.id||"edit_"+w}).click(function(){if(!e(this).hasClass("ui-state-disabled")){var t=f.p.selrow;if(t){if(e.isFunction(n.editfunc)){n.editfunc.call(f,t)}else{e(f).jqGrid("editGridRow",t,r)}}else{e.jgrid.viewModal("#"+a.themodal,{gbox:"#gbox_"+e.jgrid.jqID(f.p.id),jqm:true});e("#jqg_alrt").focus()}}return false}).hover(d,v);m=null}if(n.view){m=e("<td class='ui-pg-button ui-corner-all'></td>");u=u||{};e(m).append("<div class='ui-pg-div'><span class='ui-icon "+n.viewicon+"'></span>"+n.viewtext+"</div>");e("tr",g).append(m);e(m,g).attr({title:n.viewtitle||"",id:u.id||"view_"+w}).click(function(){if(!e(this).hasClass("ui-state-disabled")){var t=f.p.selrow;if(t){if(e.isFunction(n.viewfunc)){n.viewfunc.call(f,t)}else{e(f).jqGrid("viewGridRow",t,u)}}else{e.jgrid.viewModal("#"+a.themodal,{gbox:"#gbox_"+e.jgrid.jqID(f.p.id),jqm:true});e("#jqg_alrt").focus()}}return false}).hover(d,v);m=null}if(n.del){m=e("<td class='ui-pg-button ui-corner-all'></td>");s=s||{};e(m).append("<div class='ui-pg-div'><span class='ui-icon "+n.delicon+"'></span>"+n.deltext+"</div>");e("tr",g).append(m);e(m,g).attr({title:n.deltitle||"",id:s.id||"del_"+w}).click(function(){if(!e(this).hasClass("ui-state-disabled")){var t;if(f.p.multiselect){t=f.p.selarrrow;if(t.length===0){t=null}}else{t=f.p.selrow}if(t){if(e.isFunction(n.delfunc)){n.delfunc.call(f,t)}else{e(f).jqGrid("delGridRow",t,s)}}else{e.jgrid.viewModal("#"+a.themodal,{gbox:"#gbox_"+e.jgrid.jqID(f.p.id),jqm:true});e("#jqg_alrt").focus()}}return false}).hover(d,v);m=null}if(n.add||n.edit||n.del||n.view){e("tr",g).append(y)}if(n.search){m=e("<td class='ui-pg-button ui-corner-all'></td>");o=o||{};e(m).append("<div class='ui-pg-div'><span class='ui-icon "+n.searchicon+"'></span>"+n.searchtext+"</div>");e("tr",g).append(m);e(m,g).attr({title:n.searchtitle||"",id:o.id||"search_"+w}).click(function(){if(!e(this).hasClass("ui-state-disabled")){if(e.isFunction(n.searchfunc)){n.searchfunc.call(f,o)}else{e(f).jqGrid("searchGrid",o)}}return false}).hover(d,v);if(o.showOnLoad&&o.showOnLoad===true){e(m,g).click()}m=null}if(n.refresh){m=e("<td class='ui-pg-button ui-corner-all'></td>");e(m).append("<div class='ui-pg-div'><span class='ui-icon "+n.refreshicon+"'></span>"+n.refreshtext+"</div>");e("tr",g).append(m);e(m,g).attr({title:n.refreshtitle||"",id:"refresh_"+w}).click(function(){if(!e(this).hasClass("ui-state-disabled")){if(e.isFunction(n.beforeRefresh)){n.beforeRefresh.call(f)}f.p.search=false;f.p.resetsearch=true;try{var t=f.p.id;f.p.postData.filters="";try{e("#fbox_"+e.jgrid.jqID(t)).jqFilter("resetFilter")}catch(r){}if(e.isFunction(f.clearToolbar)){f.clearToolbar.call(f,false)}}catch(i){}switch(n.refreshstate){case"firstpage":e(f).trigger("reloadGrid",[{page:1}]);break;case"current":e(f).trigger("reloadGrid",[{current:true}]);break}if(e.isFunction(n.afterRefresh)){n.afterRefresh.call(f)}}return false}).hover(d,v);m=null}c=e(".ui-jqgrid").css("font-size")||"11px";e("body").append("<div id='testpg2' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+c+";visibility:hidden;' ></div>");l=e(g).clone().appendTo("#testpg2").width();e("#testpg2").remove();e(b+"_"+n.position,b).append(g);if(f.p._nvtd){if(l>f.p._nvtd[0]){e(b+"_"+n.position,b).width(l);f.p._nvtd[0]=l}f.p._nvtd[1]=l}c=null;l=null;g=null;this.nav=true}})},navButtonAdd:function(t,n){n=e.extend({caption:"newButton",title:"",buttonicon:"ui-icon-newwin",onClickButton:null,position:"last",cursor:"pointer"},n||{});return this.each(function(){if(!this.grid){return}if(typeof t==="string"&&t.indexOf("#")!==0){t="#"+e.jgrid.jqID(t)}var r=e(".navtable",t)[0],i=this;if(r){if(n.id&&e("#"+e.jgrid.jqID(n.id),r)[0]!==undefined){return}var s=e("<td></td>");if(n.buttonicon.toString().toUpperCase()==="NONE"){e(s).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'>"+n.caption+"</div>")}else{e(s).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'><span class='ui-icon "+n.buttonicon+"'></span>"+n.caption+"</div>")}if(n.id){e(s).attr("id",n.id)}if(n.position==="first"){if(r.rows[0].cells.length===0){e("tr",r).append(s)}else{e("tr td:eq(0)",r).before(s)}}else{e("tr",r).append(s)}e(s,r).attr("title",n.title||"").click(function(t){if(!e(this).hasClass("ui-state-disabled")){if(e.isFunction(n.onClickButton)){n.onClickButton.call(i,t)}}return false}).hover(function(){if(!e(this).hasClass("ui-state-disabled")){e(this).addClass("ui-state-hover")}},function(){e(this).removeClass("ui-state-hover")})}})},navSeparatorAdd:function(t,n){n=e.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},n||{});return this.each(function(){if(!this.grid){return}if(typeof t==="string"&&t.indexOf("#")!==0){t="#"+e.jgrid.jqID(t)}var r=e(".navtable",t)[0];if(r){var i="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+n.sepclass+"'></span>"+n.sepcontent+"</td>";if(n.position==="first"){if(r.rows[0].cells.length===0){e("tr",r).append(i)}else{e("tr td:eq(0)",r).before(i)}}else{e("tr",r).append(i)}}})},GridToForm:function(t,n){return this.each(function(){var r=this,i;if(!r.grid){return}var s=e(r).jqGrid("getRowData",t);if(s){for(i in s){if(s.hasOwnProperty(i)){if(e("[name="+e.jgrid.jqID(i)+"]",n).is("input:radio")||e("[name="+e.jgrid.jqID(i)+"]",n).is("input:checkbox")){e("[name="+e.jgrid.jqID(i)+"]",n).each(function(){if(e(this).val()==s[i]){e(this)[r.p.useProp?"prop":"attr"]("checked",true)}else{e(this)[r.p.useProp?"prop":"attr"]("checked",false)}})}else{e("[name="+e.jgrid.jqID(i)+"]",n).val(s[i])}}}}})},FormToGrid:function(t,n,r,i){return this.each(function(){var s=this;if(!s.grid){return}if(!r){r="set"}if(!i){i="first"}var o=e(n).serializeArray();var u={};e.each(o,function(e,t){u[t.name]=t.value});if(r==="add"){e(s).jqGrid("addRowData",t,u,i)}else if(r==="set"){e(s).jqGrid("setRowData",t,u)}})}})})(jQuery)