(function(e){e.jgrid.extend({setColumns:function(t){t=e.extend({top:0,left:0,width:200,height:"auto",dataheight:"auto",modal:false,drag:true,beforeShowForm:null,afterShowForm:null,afterSubmitForm:null,closeOnEscape:true,ShrinkToFit:false,jqModal:false,saveicon:[true,"left","ui-icon-disk"],closeicon:[true,"left","ui-icon-close"],onClose:null,colnameview:true,closeAfterSubmit:true,updateAfterCheck:false,recreateForm:false},e.jgrid.col,t||{});return this.each(function(){var n=this;if(!n.grid){return}var r=typeof t.beforeShowForm==="function"?true:false;var s=typeof t.afterShowForm==="function"?true:false;var o=typeof t.afterSubmitForm==="function"?true:false;var u=n.p.id,a="ColTbl_"+u,f={themodal:"colmod"+u,modalhead:"colhd"+u,modalcontent:"colcnt"+u,scrollelm:a};if(t.recreateForm===true&&e("#"+f.themodal).html()!=null){e("#"+f.themodal).remove()}if(e("#"+f.themodal).html()!=null){if(r){t.beforeShowForm(e("#"+a))}e.jgrid.viewModal("#"+f.themodal,{gbox:"#gbox_"+u,jqm:t.jqModal,jqM:false,modal:t.modal});if(s){t.afterShowForm(e("#"+a))}}else{var l=isNaN(t.dataheight)?t.dataheight:t.dataheight+"px";var c="<div id='"+a+"' class='formdata' style='width:100%;overflow:auto;position:relative;height:"+l+";'>";c+="<table class='ColTable' cellspacing='1' cellpading='2' border='0'><tbody>";for(i=0;i<this.p.colNames.length;i++){if(!n.p.colModel[i].hidedlg){c+="<tr><td style='white-space: pre;'><input type='checkbox' style='margin-right:5px;' id='col_"+this.p.colModel[i].name+"' class='cbox' value='T' "+(this.p.colModel[i].hidden===false?"checked":"")+"/>"+"<label for='col_"+this.p.colModel[i].name+"'>"+this.p.colNames[i]+(t.colnameview?" ("+this.p.colModel[i].name+")":"")+"</label></td></tr>"}}c+="</tbody></table></div>";var h=!t.updateAfterCheck?"<a href='javascript:void(0)' id='dData' class='fm-button ui-state-default ui-corner-all'>"+t.bSubmit+"</a>":"",d="<a href='javascript:void(0)' id='eData' class='fm-button ui-state-default ui-corner-all'>"+t.bCancel+"</a>";c+="<table border='0' class='EditTable' id='"+a+"_2'><tbody><tr style='display:block;height:3px;'><td></td></tr><tr><td class='DataTD ui-widget-content'></td></tr><tr><td class='ColButton EditButton'>"+h+"&#160;"+d+"</td></tr></tbody></table>";t.gbox="#gbox_"+u;e.jgrid.createModal(f,c,t,"#gview_"+n.p.id,e("#gview_"+n.p.id)[0]);if(t.saveicon[0]==true){e("#dData","#"+a+"_2").addClass(t.saveicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+t.saveicon[2]+"'></span>")}if(t.closeicon[0]==true){e("#eData","#"+a+"_2").addClass(t.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+t.closeicon[2]+"'></span>")}if(!t.updateAfterCheck){e("#dData","#"+a+"_2").click(function(r){for(i=0;i<n.p.colModel.length;i++){if(!n.p.colModel[i].hidedlg){var s=n.p.colModel[i].name.replace(/\./g,"\\.");if(e("#col_"+s,"#"+a).attr("checked")){e(n).jqGrid("showCol",n.p.colModel[i].name);e("#col_"+s,"#"+a).attr("defaultChecked",true)}else{e(n).jqGrid("hideCol",n.p.colModel[i].name);e("#col_"+s,"#"+a).attr("defaultChecked","")}}}if(t.ShrinkToFit===true){e(n).jqGrid("setGridWidth",n.grid.width-.001,true)}if(t.closeAfterSubmit)e.jgrid.hideModal("#"+f.themodal,{gb:"#gbox_"+u,jqm:t.jqModal,onClose:t.onClose});if(o){t.afterSubmitForm(e("#"+a))}return false})}else{e(":input","#"+a).click(function(r){var i=this.id.substr(4);if(i){if(this.checked){e(n).jqGrid("showCol",i)}else{e(n).jqGrid("hideCol",i)}if(t.ShrinkToFit===true){e(n).jqGrid("setGridWidth",n.grid.width-.001,true)}}return this})}e("#eData","#"+a+"_2").click(function(n){e.jgrid.hideModal("#"+f.themodal,{gb:"#gbox_"+u,jqm:t.jqModal,onClose:t.onClose});return false});e("#dData, #eData","#"+a+"_2").hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")});if(r){t.beforeShowForm(e("#"+a))}e.jgrid.viewModal("#"+f.themodal,{gbox:"#gbox_"+u,jqm:t.jqModal,jqM:true,modal:t.modal});if(s){t.afterShowForm(e("#"+a))}}})}})})(jQuery)